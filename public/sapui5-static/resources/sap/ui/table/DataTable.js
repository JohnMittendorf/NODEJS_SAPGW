/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 * 
 * (c) Copyright 2009-2012 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.ui.table.DataTable");jQuery.sap.require("sap.ui.table.library");jQuery.sap.require("sap.ui.core.Control");sap.ui.core.Control.extend("sap.ui.table.DataTable",{metadata:{publicMethods:["bindRows","unbindRows","addSelectedIndex","removeSelectedIndex","getSelectedIndices","setSelectedIndices","addSelectedIndices","isIndexSelected","clearSelection","selectAll","getContextByIndex"],library:"sap.ui.table",properties:{"title":{type:"string",group:"",defaultValue:null},"width":{type:"sap.ui.core.CSSSize",group:"",defaultValue:'auto'},"visibleRowCount":{type:"int",group:"",defaultValue:10},"expandedVisibleRowCount":{type:"int",group:"",defaultValue:null},"firstVisibleRow":{type:"int",group:"",defaultValue:0},"selectionMode":{type:"sap.ui.table.SelectionMode",group:"",defaultValue:sap.ui.table.SelectionMode.Multi},"editable":{type:"boolean",group:"",defaultValue:false},"expanded":{type:"boolean",group:"",defaultValue:false},"threshold":{type:"int",group:"",defaultValue:100},"selectedIndex":{type:"int",group:"",defaultValue:-1},"rowHeight":{type:"sap.ui.core.CSSSize",group:"",defaultValue:''},"allowColumnReordering":{type:"boolean",group:"",defaultValue:true},"hierarchical":{type:"boolean",group:"",defaultValue:false},"expandFirstLevel":{type:"boolean",group:"",defaultValue:false}},defaultAggregation:"columns",aggregations:{"columns":{type:"sap.ui.table.Column",multiple:true,singularName:"column"},"toolbar":{type:"sap.ui.commons.Toolbar",multiple:false}},events:{"rowSelect":{},"columnSelect":{},"toggleOpenState":{}}}});sap.ui.table.DataTable.M_EVENTS={'rowSelect':'rowSelect','columnSelect':'columnSelect','toggleOpenState':'toggleOpenState'};jQuery.sap.require("sap.ui.core.Popup");jQuery.sap.require("sap.ui.commons.Label");jQuery.sap.require("sap.ui.commons.Image");jQuery.sap.require("sap.ui.core.delegate.ItemNavigation");sap.ui.table.DataTable.getMetadata()._mHiddenAggregations={"rows":{multiple:true,type:"sap.ui.core.Control"}};
sap.ui.table.DataTable.prototype.init=function(){this.oResBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.table");this.bIsACC=sap.ui.getCore().getConfiguration().getAccessibility();this.bRTL=sap.ui.getCore().getConfiguration().getRTL();this.aSelectedIndices=[];this.iRowHeight=0;this.iBindingTimeout=50;this._bNeedsUpdateBindings=false;this.oPopup=new sap.ui.core.Popup();this.oPopup.setContent(new sap.ui.commons.Label()).setDurations(250,1000);this.oPopup.getContent().addStyleClass("sapUiTblVSbTooltip");this.attachBrowserEvent(jQuery.browser.mozilla?"DOMMouseScroll":"mousewheel",jQuery.proxy(this.onmousewheel,this));this._bHideSbTtForIE8=true;};
sap.ui.table.DataTable.prototype.exit=function(){this._destroyItemNavigation();this.oPopup.destroy();if(this._sBindingTimer){jQuery.sap.clearDelayedCall(this._sBindingTimer);}if(this._sTooltipOpenTimer){jQuery.sap.clearDelayedCall(this._sTooltipOpenTimer);}if(this._sTooltipCloseTimer){jQuery.sap.clearDelayedCall(this._sTooltipCloseTimer);}if(this._sDragStartTimer){jQuery.sap.clearDelayedCall(this._sDragStartTimer);}if(this._sResizeListenerId){sap.ui.core.ResizeHandler.deregister(this._sResizeListenerId);this._sResizeListenerId=null;}};
sap.ui.table.DataTable.prototype.onThemeChanged=function(){this._renderVSb();};
sap.ui.table.DataTable.prototype.onresize=function(){var $=this.$();var s=$.find(".sapUiTblCtrlScr");if($.find(".sapUiTblCtrl").width()>s.width()){s.css("overflow-x","scroll");$.find(".sapUiTblVSb").css("bottom","16px");}else{s.css("overflow-x","hidden");$.find(".sapUiTblVSb").css("bottom","0");}};
sap.ui.table.DataTable.prototype.getCurrentVisibleRowCount=function(){if(this.getExpanded()){return Math.max(this.getVisibleRowCount(),this.getExpandedVisibleRowCount());}else{return this.getVisibleRowCount();}};
sap.ui.table.DataTable.prototype.getContextByIndex=function(i){return this.isBound()?this.getBinding().getContexts(i,1)[0]:undefined;};
sap.ui.table.DataTable.prototype.setFirstVisibleRow=function(f){if(this.isBound()){f=Math.max(f,0);f=Math.min(f,this.getBinding().getLength()-this.getCurrentVisibleRowCount());}if(f===this.getFirstVisibleRow()){return;}this.setProperty("firstVisibleRow",f,true);if(this.bOutput){this._renderVSb();this._renderVSbToolTip();if(this._sBindingTimer){jQuery.sap.clearDelayedCall(this._sBindingTimer);}this._sBindingTimer=jQuery.sap.delayedCall(this.iBindingTimeout,this,"_updateBindings");}};
sap.ui.table.DataTable.prototype.onBeforeRendering=function(){if(this._sResizeListenerId){sap.ui.core.ResizeHandler.deregister(this._sResizeListenerId);this._sResizeListenerId=null;}var $=this.$();$.find("table > tbody > tr").unbind();$.find("table > tbody > tr > td:first-child").unbind();$.find("table > thead > tr > th").unbind();$.find(".sapUiTblExp").unbind();if(this.isTreeBinding){$.find(".sapUiTblTreeIcon").unbind();}};
sap.ui.table.DataTable.prototype.onAfterRendering=function(e){var $=this.$();var r=$.find("table > tbody > tr");r.hover(jQuery.proxy(this._onRowHover,this));r.mousemove(jQuery.proxy(this._onRowOver,this));if(this.getSelectionMode()!=sap.ui.table.SelectionMode.None){var o=undefined;if(this.getEditable()){o=$.find("table > tbody > tr > td:first-child");}else{o=$.find("table > tbody > tr");}o.click(jQuery.proxy(this._onRowSelect,this));}var t=$.find("table > thead > tr > th");t.hover(jQuery.proxy(this._onColumnHover,this));t.mousemove(jQuery.proxy(this._onColumnOver,this));t.click(jQuery.proxy(this._onColumnSelect,this));$.find(".sapUiTblExp").click(jQuery.proxy(function(e){this.setExpanded(!this.getExpanded());},this));$.find(".sapUiTblColSelAll").click(jQuery.proxy(this._onSelectAll,this));t.mousedown(jQuery.proxy(function(e){this._bDragAndDrop=false;if(!this._sDragStartTimer){this._sDragStartTimer=jQuery.sap.delayedCall(150,this,"_onColumnDragStart",[e]);}},this));t.mouseup(jQuery.proxy(function(e){if(this._sDragStartTimer){jQuery.sap.clearDelayedCall(this._sDragStartTimer);}this._sDragStartTimer=null;},this));if(this.isTreeBinding()){$.find(".sapUiTblTreeIcon").click(jQuery.proxy(this._onNodeClick,this));}var c=this.getColumns();for(var i=0,l=c.length;i<l;i++){c[i]._restoreIcons();}this._renderVSb();this._sResizeListenerId=sap.ui.core.ResizeHandler.register(this.getDomRef(),jQuery.proxy(this.onresize,this));this.onresize();if(this._bNeedsUpdateBindings){if(this._sBindingTimer){jQuery.sap.clearDelayedCall(this._sBindingTimer);this._sBindingTimer=null;}if(!this._sBindingTimer){this._bNeedsUpdateBindings=false;this._sBindingTimer=jQuery.sap.delayedCall(0,this,"_updateBindings");}}this._initItemNavigation();};
sap.ui.table.DataTable.prototype._onSelectAll=function(e){if(this.isBound()){if(this.getBinding().getLength()===this.aSelectedIndices.length){this.clearSelection();this.fireRowSelect({rowIndex:-1});}else{this.selectAll();this.fireRowSelect({rowIndex:0,rowContext:this.getContextByIndex(0)});}}};
sap.ui.table.DataTable.prototype._onRowHover=function(e){var r=this.$().find("table > tbody > tr");r.removeClass("sapUiTblRowHvr");};
sap.ui.table.DataTable.prototype._onRowOver=function(e){var $=jQuery(e.target).parents("tr");if($.length==0){$=jQuery(e.target);}$.addClass("sapUiTblRowHvr");};
sap.ui.table.DataTable.prototype._onRowSelect=function(e){if(!this.isBound()){return;}var s=this.getSelectionMode()==sap.ui.table.SelectionMode.Single;var b=!s&&e.shiftKey;var $=jQuery(e.target).parents("tr");if($.length>0){var r=parseInt($[0].id.substring((this.getId()+"-row").length),10);var a=this.getFirstVisibleRow()+r;if(a<this.getBinding().getLength()){if(!b){if(this.isIndexSelected(a)&&!!(e.metaKey||e.ctrlKey)){this.removeSelectedIndex(a,true);this._visualizeSelection(r,false);this.fireRowSelect({rowIndex:-1});}else{if(s||!(e.metaKey||e.ctrlKey)){for(var i=0,l=this.getCurrentVisibleRowCount();i<l;i++){this._visualizeSelection(i,false);}this.setSelectedIndex(a,true);}else{this.addSelectedIndex(a,true);}if(this.isIndexSelected(a)){this._visualizeSelection(r,true);}this.fireRowSelect({rowIndex:a,rowContext:this.getContextByIndex(a)});}}else{if(!s){var c=this.getSelectedIndex();this.clearSelection(true);var d=[];if(c<a){for(var i=c;i<=a;i++){d.push(i);}}else{for(var i=c;i>=a;i--){d.push(i);}}this.addSelectedIndices(d,true);this._updateBindings();this.fireRowSelect({rowIndex:a,rowContext:this.getContextByIndex(a)});}}}this._clearTextSelection();}};
sap.ui.table.DataTable.prototype._onColumnHover=function(e){var t=this.$().find("table > thead > tr > th");t.removeClass("sapUiTblColHvr");};
sap.ui.table.DataTable.prototype._onColumnOver=function(e){var $=jQuery(e.target).parents("th");if($.length==0){$=jQuery(e.target);}$.addClass("sapUiTblColHvr");};
sap.ui.table.DataTable.prototype._onColumnSelect=function(e){if(this._bDragAndDrop){return;}var d=jQuery(e.target).closest("th").get(0);var c;jQuery.each(this.getColumns(),function(k,v){if(v.getId()===d.id){c=v;return true;}});if(c){var b=this.fireEvent("columnSelect",{column:c},true);if(b){c._openMenu();}}};
sap.ui.table.DataTable.prototype._onSelectStart=function(e){e.preventDefault();e.stopPropagation();return false;};
sap.ui.table.DataTable.prototype._onColumnDragStart=function(e){this._bDragAndDrop=true;this._sSourceColumnId=jQuery(e.target).closest("th").get(0).id;var c=sap.ui.getCore().byId(this._sSourceColumnId);var $=c.$();var o=$.offset().left+$.width();var i=jQuery("#"+this.getId()+"_resize_"+this._sSourceColumnId).rectContains(e.pageX,e.pageY);if(i&&c.getResizable()||!i&&this.getAllowColumnReordering()&&(!this.isTreeBinding()||jQuery.inArray(c,this.getColumns())>0)){this._clearTextSelection();jQuery(document.body).bind("selectstart",this._onSelectStart);jQuery(document.body).mousemove(jQuery.proxy(!i?this._onColumnDrag:this._onColumnResize,this));jQuery(document.body).mouseup(jQuery.proxy(!i?this._onColumnDrop:this._onColumnResized,this));}};
sap.ui.table.DataTable.prototype._onColumnDrag=function(e){this._clearTextSelection();var t=this.$().find("table > thead > tr > th:not(.sapUiTblColSelCell)");if(this.isTreeBinding()){t=t.filter(function(i){return i>0;});}t.css("borderColor","");var a=this;jQuery.each(t,function(k,v){var $=jQuery(v);if(e.pageX>=$.offset().left&&e.pageX<=$.offset().left+$.width()){var b=e.pageX<=$.offset().left+$.outerWidth()/2;var c=b?sap.ui.core.Popup.Dock.BeginTop:sap.ui.core.Popup.Dock.EndTop;var s=sap.ui.getCore().getConfiguration().getTheme();a.oMarkerPopup=a.oMarkerPopup||new sap.ui.core.Popup(a.getId()+"-dnd",false,false,true).setContent(new sap.ui.commons.Image({src:sap.ui.resource("sap.ui.table","themes/"+s+"/img/ico12_help_options.gif")})).setDurations(250,1000);a.oMarkerPopup.setPosition(c,c,v,b?"-7 -9":"5 -9");if(!a.oMarkerPopup.isOpen()){a.oMarkerPopup.open();}}});};
sap.ui.table.DataTable.prototype._onColumnDrop=function(e){var t=this.$().find("table > thead > tr > th:not(.sapUiTblColSelCell)");if(this.isTreeBinding()){t=t.filter(function(i){return i>0;});}t.css("borderColor","");var a=this;jQuery.each(t,function(k,v){var $=jQuery(v);if(e.pageX>=$.offset().left&&e.pageX<=$.offset().left+$.width()){var b=e.pageX<=$.offset().left+$.width()/2;var s=a.getColumnById(a._sSourceColumnId);var o=a.getColumnById(v.id);if(s!=o){a.removeColumn(s);a.insertColumn(s,a.indexOfColumn(o)+(b?0:1));}}});if(this.oMarkerPopup&&this.oMarkerPopup.isOpen()){this.oMarkerPopup.close();}jQuery(document.body).unbind("selectstart",this._onSelectStart);jQuery(document.body).unbind("mousemove",this._onColumnDrag);jQuery(document.body).unbind("mouseup",this._onColumnDrop);this._sSourceColumnId="";};
sap.ui.table.DataTable.prototype._onColumnResize=function(e){this._clearTextSelection();var c=jQuery.sap.byId(this._sSourceColumnId);var n=Math.max(1,e.pageX-c.offset().left);c.css("width",n+"px");this.getColumnById(this._sSourceColumnId).setProperty("width",n+"px",true);this.onresize();};
sap.ui.table.DataTable.prototype._onColumnResized=function(e){jQuery(document.body).unbind("selectstart",this._onSelectStart);jQuery(document.body).unbind("mousemove",this._onColumnResize);jQuery(document.body).unbind("mouseup",this._onColumnResized);this._sSourceColumnId="";};
sap.ui.table.DataTable.prototype._onNodeClick=function(e){var $=jQuery(e.target).parents("tr");if($.length>0){var r=this.getFirstVisibleRow()+parseInt($[0].id.substring((this.getId()+"-row").length),10);var c=this.getContextByIndex(r);this.fireToggleOpenState({rowIndex:r,rowContext:c,expanded:!this.getBinding().isExpanded(c)});this.getBinding().toggleContext(c);}e.preventDefault();e.stopPropagation();};
sap.ui.table.DataTable.prototype._clearTextSelection=function(){if(window.getSelection&&window.getSelection().removeAllRanges){try{window.getSelection().removeAllRanges();}catch(e){}}};
sap.ui.table.DataTable.prototype.onmousewheel=function(e){if(this._$VSb){var $=this.$();if($.find(".sapUiTblCtrl > tbody :focus").length>0){$.find(".sapUiTblCtrl > tbody").focus();}var c=this._$VSb.scrollTop();var o=e.originalEvent;var d=(o.detail&&o.detail>0)||(o.wheelDelta&&o.wheelDelta<0);var n=c+this.iRowHeight*(d?1:-1);this._$VSb.scrollTop(n);e.preventDefault();e.stopPropagation();return false;}};
sap.ui.table.DataTable.prototype.onscroll=function(e){var c=this._$VSb?this._$VSb.scrollTop():0;var f=Math.round(c/this.iRowHeight);if(isNaN(f)){f=0;}this.setFirstVisibleRow(f);};
sap.ui.table.DataTable.prototype.bindAggregation=function(n,p,t,s,f){var o=n==="rows"&&!t?{}:t;sap.ui.core.Element.prototype.bindAggregation.call(this,n,p,o,s,f);};
sap.ui.table.DataTable.prototype._bindAggregation=function(n,p,t,s,f){sap.ui.core.Element.prototype._bindAggregation.apply(this,arguments);var b=this.getBinding();if(n==="rows"&&b){b.attachSort(this._onBindingSort,this);b.attachFilter(this._onBindingFilter,this);}return this;};
sap.ui.table.DataTable.prototype.unbindAggregation=function(n,p,t,s,f){var b=this.getBinding();if(n==="rows"&&b){b.detachSort(this._onBindingSort);b.detachFilter(this._onBindingFilter);}return sap.ui.core.Element.prototype.unbindAggregation.apply(this,arguments);};
sap.ui.table.DataTable.prototype.bindRows=function(p,s,f){return this.bindAggregation("rows",p,undefined,s,f);};
sap.ui.table.DataTable.prototype.unbindRows=function(){return this.unbindAggregation("rows");};
sap.ui.table.DataTable.prototype._addControl=function(e,s){return this.addAggregation("rows",e,s);};
sap.ui.table.DataTable.prototype._destroyControls=function(s){return this.destroyAggregation("rows",s);};
sap.ui.table.DataTable.prototype._onBindingSort=function(e){if(this.getSelectedIndex()!==-1){this.clearSelection(true);this.fireRowSelect({rowIndex:-1});}this._updateBindings();};
sap.ui.table.DataTable.prototype._onBindingFilter=function(e){if(this.getSelectedIndex()!==-1){this.clearSelection(true);this.fireRowSelect({rowIndex:-1});}this._updateBindings();};
sap.ui.table.DataTable.prototype.getBinding=function(n){var b=sap.ui.core.Element.prototype.getBinding.apply(this,[n||"rows"]);if(b&&this.isTreeBinding()&&(n||"rows")==="rows"&&!b.getLength){jQuery.extend(b,({_init:function(){return this;},updateData:function(){this.aContexts=this.getRootContexts();this.mContextInfo={};for(var i=0,l=this.aContexts.length;i<l;i++){this.mContextInfo[this.aContexts[i]]={iLevel:0,bExpanded:false,bHasChildren:this.hasChildContexts(this.aContexts[i])};}},getLength:function(){return this.aContexts.length;},getContexts:function(s,a){var c=[];for(var i=s,l=s+a;i<l;i++){c.push(this.aContexts[i]);}return c;},getLevel:function(c){return this.mContextInfo[c]?this.mContextInfo[c].iLevel:-1;},isExpanded:function(c){return this.mContextInfo[c]?this.mContextInfo[c].bExpanded:false;},hasChildren:function(c){return this.mContextInfo[c]?this.mContextInfo[c].bHasChildren:false;},hasChildContexts:function(c){return this.getNodeContexts(c).length>0;},expandContext:function(c){var o=this.mContextInfo[c];if(o&&!o.bExpanded){var a=jQuery.inArray(c,this.aContexts);var d=this.getNodeContexts(c);for(var i=0,l=d.length;i<l;i++){this.aContexts.splice(a+i+1,0,d[i]);this.mContextInfo[d[i]]={iLevel:this.mContextInfo[c].iLevel+1,bExpanded:false,bHasChildren:this.hasChildContexts(d[i])};}this.mContextInfo[c].bExpanded=true;this._fireChange();}},collapseContext:function(c){var o=this.mContextInfo[c];if(o&&o.bExpanded){for(var i=this.aContexts.length-1;i>0;i--){if(this.aContexts[i]!==c&&this.aContexts[i].substring(0,c.length)===c){this.aContexts.splice(i,1);}}this.mContextInfo[c].bExpanded=false;this._fireChange();}},toggleContext:function(c){if(this.mContextInfo[c].bExpanded){this.collapseContext(c);}else{this.expandContext(c);}},attachSort:function(){},detachSort:function(){}}._init()));b.attachChange(function(e){if(this.getSelectedIndex()!==-1){this.clearSelection();this.fireRowSelect({rowIndex:-1});}},this);b.updateData();if(this.getExpandFirstLevel()&&b.aContexts){jQuery.each(b.aContexts.slice(),function(i,c){b.expandContext(c);});}}return b;};
sap.ui.table.DataTable.prototype.getBindingPath=function(n){return sap.ui.core.Element.prototype.getBindingPath.apply(this,[n||"rows"]);};
sap.ui.table.DataTable.prototype.isBound=function(n){return sap.ui.core.Element.prototype.isBound.apply(this,[n||"rows"]);};
sap.ui.table.DataTable.prototype.updateRows=function(){this._renderVSb();this._updateBindings();};
sap.ui.table.DataTable.prototype.isTreeBinding=function(n){return this.getHierarchical();};
sap.ui.table.DataTable.prototype._updateBindings=function(){if(this.isBound()){if(this.getDomRef()){var b=this.getBinding();var d=new Date();var s=this.getFirstVisibleRow();var o=this.getCurrentVisibleRowCount();var l=b.getLength();var h=this.isTreeBinding();if(s+o>l){s=0;this.setProperty("firstVisibleRow",s,true);}var c=b.getContexts(s,o,this.getThreshold());var a=jQuery.sap.getModulePath("sap.ui.table",'/')+"themes/"+sap.ui.getCore().getConfiguration().getTheme()+"/img/";for(var r=0;r<this._aRows.length;r++){var e=c[r];for(var f=0;f<this._aRows[r].length;f++){var g=this._aRows[r][f];if(g.getBindingContext()!=e){g.setBindingContext(e);}}var $=jQuery.sap.byId(this.getId()+"-row"+r);if(r+s<l){this._visualizeSelection(r,this.isIndexSelected(r+s));if(h){var i=b.getLevel(e);var t=jQuery.sap.byId(this.getId()+"-row"+r).find(".sapUiTblTreeIcon");t.css("marginLeft",i*17);var j="sapUiTblTreeIconLeaf";if(b.hasChildren(e)){j=b.isExpanded(e)?"sapUiTblTreeIconNodeOpen":"sapUiTblTreeIconNodeClosed";}t.removeClass("sapUiTblTreeIconLeaf sapUiTblTreeIconNodeOpen sapUiTblTreeIconNodeClosed").addClass(j);$.attr("data-sap-ui-level",i)}$.removeClass("sapUiTblCntHdn");}else{$.addClass("sapUiTblCntHdn");if(h){$.removeAttr("data-sap-ui-level");}this._visualizeSelection(r,false);}}var k=new Date()-d;this.iBindingTimeout=k+10;}else{this._bNeedsUpdateBindings=true;}}this._sBindingTimer=null;};
sap.ui.table.DataTable.prototype._visualizeSelection=function(r,s){if(s){jQuery.sap.byId(this.getId()+"-row"+r).addClass("sapUiTblRowSel").find(".sapUiTblRowSelCell").attr("title",this.oResBundle.getText("TBL_ROW_DESELECT")).parent().attr("aria-selected","true");}else{jQuery.sap.byId(this.getId()+"-row"+r).removeClass("sapUiTblRowSel").find(".sapUiTblRowSelCell").attr("title",this.oResBundle.getText("TBL_ROW_SELECT")).parent().removeAttr("aria-selected");}};
sap.ui.table.DataTable.prototype._renderVSb=function(){if(this._$VSb){this.iRowHeight=0;this._$VSb.unbind();this._$VSb=null;}var t=this.$();var s=t.find(".sapUiTblVSb");var o=jQuery.sap.domById(this.getId()+"-vsbcont");var b=this.getBinding("rows");if(this.bOutput&&b){var f=Math.max(0,this.getFirstVisibleRow());var v=this.getCurrentVisibleRowCount();var r=b.getLength();if(r>v){var $=jQuery(o),a=jQuery.sap.byId(this.getId()+"-vsb"),c=jQuery.sap.byId(this.getId()+"-vsbimg");t.addClass("sapUiTblHasVSb");this.iRowHeight=a.height()/v;this.iStepSize=this.iRowHeight*r/(a.height()-32-1);c.height(this.iRowHeight*r);a.scrollTop(this.iRowHeight*f);this._$VSb=a;this._$VSb.bind("scroll",jQuery.proxy(this.onscroll,this));}else{t.removeClass("sapUiTblHasVSb");}}else{t.removeClass("sapUiTblHasVSb");}};
sap.ui.table.DataTable.prototype._renderVSbToolTip=function(){if(this._$VSb){var s=this.getFirstVisibleRow();var t=this.oResBundle.getText("TBL_TOOLTIP",[s+1,s+this.getCurrentVisibleRowCount(),this.getBinding("rows").getLength()]);this.oPopup.getContent().setProperty("text",t,true);this.oPopup.getContent().rerender();var e=sap.ui.core.Popup.Dock;var o=this._$VSb.offset();var a=this.bRTL?"20":"-20";if(this.bRTL&&(jQuery.browser.webkit||jQuery.browser.mozilla&&jQuery.browser.fVersion<4)){a="36";}var d=this.bRTL?e.BeginTop:e.EndTop;this.oPopup.setPosition(d,d,this._$VSb[0],a+" "+(16+this._$VSb.scrollTop()/this.iStepSize));if(!this.oPopup.isOpen()&&!this._sTooltipOpenTimer){if(!jQuery.browser.msie||!(jQuery.browser.version<9&&this._bHideSbTtForIE8)){if(this._bImmediateTooltip){this.oPopup.open();}else{this._sTooltipOpenTimer=jQuery.sap.delayedCall(25,this,function(){this.oPopup.open();this._sTooltipOpenTimer=null;});}}}if(this._sTooltipCloseTimer){jQuery.sap.clearDelayedCall(this._sTooltipCloseTimer);}this._sTooltipCloseTimer=jQuery.sap.delayedCall(1000,this,function(){this.oPopup.close();this._sTooltipCloseTimer=null;});}};
sap.ui.table.DataTable.prototype.getColumnById=function(c){var a=this.getColumns();for(var i=0;i<a.length;i++){if(a[i].getId()==c){return a[i];}}return null;};
sap.ui.table.DataTable.prototype.getSelectedIndex=function(){if(this.aSelectedIndices.length>0){return this.aSelectedIndices[0];}return-1;};
sap.ui.table.DataTable.prototype.setSelectedIndex=function(i,s){if(!this.isBound()||i<0||i>=this.getBinding().getLength()){return;}this.aSelectedIndices=[i];if(!s){this.invalidate();}};
sap.ui.table.DataTable.prototype.addSelectedIndex=function(i,s){if(this.getSelectionMode()==sap.ui.table.SelectionMode.Single){this.setSelectedIndex(i,s);}else{if(!this.isBound()||i<0||i>=this.getBinding().getLength()){return;}if(jQuery.inArray(i,this.aSelectedIndices)==-1){this.aSelectedIndices.push(i);if(!s){this.invalidate();}}}};
sap.ui.table.DataTable.prototype.removeSelectedIndex=function(i,s){var a=jQuery.inArray(i,this.aSelectedIndices);if(a!=-1){this.aSelectedIndices.splice(a,1);if(!s){this.invalidate();}}};
sap.ui.table.DataTable.prototype.clearSelection=function(s){this.aSelectedIndices=[];if(!s){this.invalidate();}};
sap.ui.table.DataTable.prototype.selectAll=function(s){this.aSelectedIndices=[];for(var i=0,l=this.getBinding().getLength();i<l;i++){this.aSelectedIndices.push(i);}if(!s){this.invalidate();}};
sap.ui.table.DataTable.prototype.getSelectedIndices=function(){var s=this.aSelectedIndices.slice();s.sort(function(a,b){return a-b;});return s;};
sap.ui.table.DataTable.prototype.setSelectedIndices=function(a,s){if(this.getSelectionMode()==sap.ui.table.SelectionMode.Single){return;}this.clearSelection(s);for(var i=0;i<a.length;i++){this.addSelectedIndex(a[i],s);}};
sap.ui.table.DataTable.prototype.addSelectedIndices=function(a,s){if(!this.getSelectionMode()==sap.ui.table.SelectionMode.Single){return;}for(var i=0;i<a.length;i++){this.addSelectedIndex(a[i],s);}};
sap.ui.table.DataTable.prototype.isIndexSelected=function(i){return jQuery.inArray(i,this.aSelectedIndices)!=-1;};
sap.ui.table.DataTable.prototype._scrollNext=function(){if(this.isBound()&&this.getFirstVisibleRow()<this.getBinding().getLength()-this.getCurrentVisibleRowCount()){this.setFirstVisibleRow(Math.min(this.getFirstVisibleRow()+1,this.getBinding().getLength()-this.getCurrentVisibleRowCount()));}};
sap.ui.table.DataTable.prototype._scrollPrevious=function(){if(this.getFirstVisibleRow()>0){this.setFirstVisibleRow(Math.max(this.getFirstVisibleRow()-1,0));}};
sap.ui.table.DataTable.prototype._scrollPageUp=function(){this.setFirstVisibleRow(Math.max(this.getFirstVisibleRow()-this.getCurrentVisibleRowCount(),0));};
sap.ui.table.DataTable.prototype._scrollPageDown=function(){if(this.isBound()){this.setFirstVisibleRow(Math.min(this.getFirstVisibleRow()+this.getCurrentVisibleRowCount(),this.getBinding().getLength()-this.getCurrentVisibleRowCount()));}};
sap.ui.table.DataTable.prototype._isTopRow=function(e){var $=jQuery(e.target);return($.parent().attr("data-sap-ui-rowindex")==0);};
sap.ui.table.DataTable.prototype._isBottomRow=function(e){var $=jQuery(e.target);return($.parent().attr("data-sap-ui-rowindex")==this.getCurrentVisibleRowCount()-1);};
sap.ui.table.DataTable.prototype.onsapdown=function(e){if(!this._ActionMode&&this._isBottomRow(e)){this._scrollNext();}};
sap.ui.table.DataTable.prototype.onsapup=function(e){if(!this._ActionMode&&this._isTopRow(e)){this._scrollPrevious();}};
sap.ui.table.DataTable.prototype.onsappagedown=function(e){if(!this._ActionMode&&this._isBottomRow(e)){this._scrollPageDown();}};
sap.ui.table.DataTable.prototype.onsappageup=function(e){if(!this._ActionMode&&this._isTopRow(e)){this._scrollPageUp();}};
sap.ui.table.DataTable.prototype.onsapselectmodifiers=sap.ui.table.DataTable.prototype.onsapselect=function(e){var $=jQuery(e.target);if($.hasClass("sapUiTblRowSelCell")){this._onRowSelect(e);}else if($.hasClass("sapUiTblColSelCell")){this._onSelectAll(e);}else{var a=$.closest("th");var c=a.control();if(c.length===1&&c[0]instanceof sap.ui.table.Column){c[0]._openMenu();}}};
sap.ui.table.DataTable.prototype._initItemNavigation=function(){var $=this.$();if(!this._oColHdrItemNav){this._oColHdrItemNav=new sap.ui.core.delegate.ItemNavigation();this._oColHdrItemNav.setCycling(false);this.addDelegate(this._oColHdrItemNav);}this._oColHdrItemNav.setRootDomRef($.find(".sapUiTblCtrl > thead").get(0));this._oColHdrItemNav.setItemDomRefs($.find(".sapUiTblCtrl > thead th").get());if(!this._oItemNavigation){this._oItemNavigation=new sap.ui.core.delegate.ItemNavigation();this._oItemNavigation.setTableMode(true);this.addDelegate(this._oItemNavigation);}this._oItemNavigation.setRootDomRef($.find(".sapUiTblCtrl > tbody").get(0));this._oItemNavigation.setItemDomRefs($.find(".sapUiTblCtrl > tbody td").get());this._oItemNavigation.setColumns(this.getColumns().length+(this.getSelectionMode()===sap.ui.table.SelectionMode.None?0:1));};
sap.ui.table.DataTable.prototype._destroyItemNavigation=function(){if(this._oColHdrItemNav){this._oColHdrItemNav.destroy();this._oColHdrItemNav=undefined;}if(this._oRowHdrItemNav){this._oRowHdrItemNav.destroy();this._oRowHdrItemNav=undefined;}if(this._oItemNavigation){this._oItemNavigation.destroy();this._oItemNavigation=undefined;}};
sap.ui.table.DataTable.prototype.onsaptabprevious=function(e){var $=this.$();if(this._bActionMode){if($.find(".sapUiTblCtrl tbody").firstFocusableDomRef()===e.target){$.find(".sapUiTblCtrl tbody").lastFocusableDomRef().focus();e.preventDefault();e.stopPropagation();}}else{console.log(this._oItemNavigation.getFocusedDomRef()===e.target);if(this._oItemNavigation.getFocusedDomRef()===e.target){$.find(".sapUiTblCtrl td:first").focus();}}};
sap.ui.table.DataTable.prototype.onsaptabnext=function(e){var $=this.$();if(this._oColHdrItemNav.getFocusedDomRef()===e.target){jQuery(this._oItemNavigation.getFocusedDomRef()||this._oItemNavigation.getRootDomRef()).focus();e.preventDefault();e.stopPropagation();}else{if(this._bActionMode){if($.find(".sapUiTblCtrl tbody").lastFocusableDomRef()===e.target){$.find(".sapUiTblCtrl tbody").firstFocusableDomRef().focus();e.preventDefault();e.stopPropagation();}}else{console.log(this._oItemNavigation.getFocusedDomRef()===e.target);if(this._oItemNavigation.getFocusedDomRef()===e.target){this._bIgnoreFocusIn=true;$.find(".sapUiTblCtrlAfter").focus();this._bIgnoreFocusIn=false;}}}};
sap.ui.table.DataTable.prototype.onkeydown=function(e){var $=this.$();if(!this._bActionMode&&e.keyCode==jQuery.sap.KeyCodes.F2||e.keyCode==jQuery.sap.KeyCodes.ENTER){if($.find(".sapUiTblCtrl td:focus").length>0){this._enterActionMode($.find(".sapUiTblCtrl td:focus :focusable").get(0));e.preventDefault();e.stopPropagation();}}};
sap.ui.table.DataTable.prototype.onsapescape=function(e){this._leaveActionMode(e);};
sap.ui.table.DataTable.prototype._enterActionMode=function(d){if(d&&!this._bActionMode){this._bActionMode=true;this.removeDelegate(this._oItemNavigation);jQuery(this._oItemNavigation.getFocusedDomRef()).attr("tabindex","-1");jQuery(d).focus();}};
sap.ui.table.DataTable.prototype._leaveActionMode=function(e){if(this._bActionMode){this._bActionMode=false;this.addDelegate(this._oItemNavigation);jQuery(this._oItemNavigation.getFocusedDomRef()).attr("tabindex","0");if(e){if(jQuery(e.target).closest("td[tabindex=-1]").length>0){var i=jQuery(this._oItemNavigation.aItemDomRefs).index(jQuery(e.target).closest("td[tabindex=-1]").get(0));this._oItemNavigation.focusItem(i,null);}else{if(jQuery.sap.containsOrEquals(this.$().find(".sapUiTblCtrl").get(0),e.target)){this._oItemNavigation.focusItem(this._oItemNavigation.getFocusedIndex(),null);}}}else{this._oItemNavigation.focusItem(this._oItemNavigation.getFocusedIndex(),null);}}};
sap.ui.table.DataTable.prototype.onfocusin=function(e){var $=jQuery(e.target);if(!this._bIgnoreFocusIn&&$.hasClass("sapUiTblCtrlAfter")){this._leaveActionMode();jQuery(this._oItemNavigation.getFocusedDomRef()||this._oItemNavigation.oDomRef).focus();}};
sap.ui.table.DataTable.prototype.onmouseup=function(e){if(this.$().find(".sapUiTblCtrl td :focus").length>0){this._enterActionMode(this.$().find(".sapUiTblCtrl td :focus").get(0));}else{this._leaveActionMode(e);}};
