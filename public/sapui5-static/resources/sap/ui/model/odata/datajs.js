/*! 
 * Copyright (c) Microsoft.  All rights reserved.
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal  in the Software without restriction, including without limitation the rights  to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR  IMPLIED, INCLUDING BUT NOT LIMITED TO THE
 * WARRANTIES OF MERCHANTABILITY,  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
 * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
 * ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 * datajs.js
 */
(function(w,u){if(!w.datajs){w.datajs={};}if(!w.OData){w.OData={};}var d=w.datajs;var o=w.OData;var P="b";var c="c";var f="entry";var g="f";var h="p";var j="s";var k="u";var l="n";var m="c";var n="d";var q="i";var r="p";var s="n";var t=function(a){return a!==null&&a!==u;};var v=function(a,b){var i,e;for(i=0,e=a.length;i<e;i++){if(a[i]===b){return true;}}return false;};var z=function(a,b){return(a!==u)?a:b;};var A=function(a){if(arguments.length===1){w.setTimeout(a,0);return;}var b=Array.prototype.slice.call(arguments,1);w.setTimeout(function(){a.apply(this,b);},0);};var B=function(a,b){if(!a){return null;}if(K(a)){var i,e,p;for(i=0,e=a.length;i<e;i++){p=B(a[i],b);if(p){return p;}}return null;}else{if(a.dataServices){return B(a.dataServices.schema,b);}return b(a);}};var C=function(a){return(a.__edmType==="Edm.DateTimeOffset"||(!a.__edmType&&a.__offset));};var D=function(a,b){if(a===0){a="";}else{a="."+H(a.toString(),3);}if(b>0){if(a===""){a=".000";}a+=H(b.toString(),4);}return a;};var E=function(a){return"\/Date("+a.getTime()+")\/";};var F=function(a){if(typeof a==="string"){return a;}var b=C(a);var e=I(a.__offset);if(b&&e!=="Z"){a=new Date(a.valueOf());var i=Z(e);var p=a.getUTCHours()+(i.d*i.h);var x=a.getMinutes()+(i.d*i.m);a.setUTCHours(p,x);}else if(!b){e="";}var y=a.getUTCFullYear();var _=a.getUTCMonth()+1;var _251="";if(y<=0){y=-(y-1);_251="-";}var _252=D(a.getUTCMilliseconds(),a.__ns);return _251+H(y,4)+"-"+H(_,2)+"-"+H(a.getUTCDate(),2)+"T"+H(a.getUTCHours(),2)+":"+H(a.getUTCMinutes(),2)+":"+H(a.getUTCSeconds(),2)+_252+e;};var G=function(a){var b=a.ms;var e="";if(b<0){e="-";b=-b;}var i=Math.floor(b/86400000);b-=86400000*i;var p=Math.floor(b/3600000);b-=3600000*p;var x=Math.floor(b/60000);b-=60000*x;var y=Math.floor(b/1000);b-=y*1000;return e+"P"+H(i,2)+"DT"+H(p,2)+"H"+H(x,2)+"M"+H(y,2)+D(b,a.ns)+"S";};var H=function(a,b,e){var i=a.toString(10);while(i.length<b){if(e){i+="0";}else{i="0"+i;}}return i;};var I=function(a){return(!a||a==="Z"||a==="+00:00"||a==="-00:00")?"Z":a;};var J=function(a,b,e,_36,i,p){return i.request(a,function(x){try{if(x.headers){U(x.headers);}if(x.data===u){_36.read(x,p);}}catch(y){if(y.request===u){y.request=a;}if(y.response===u){y.response=x;}e(y);return;}b(x.data,x);},e);};var K=function(a){return Object.prototype.toString.call(a)==="[object Array]";};var L=function(a){return Object.prototype.toString.call(a)==="[object Date]";};var M=function(p,a){if(p){var i,b;for(i=0,b=p.length;i<b;i++){if(p[i].name===a){return p[i];}}}return null;};var N=function(a,b,e){return(a)?B(b,function(_160){return S(a,_160,e);}):null;};var O=function(a,b){return N(a,b,"complexType");};var Q=function(a,b){return N(a,b,"entityType");};var R=function(a,b){if(b.indexOf(a)===0&&b.charAt(a.length)==="."){return b.substr(a.length+1);}return null;};var S=function(a,b,e){if(b){var p=R(b["namespace"],a);var x=b[e];if(p&&x){var i,y;for(i=0,y=x.length;i<y;i++){if(x[i].name===p){return x[i];}}}}return null;};var T={"accept":"Accept","content-type":"Content-Type","dataserviceversion":"DataServiceVersion","maxdataserviceversion":"MaxDataServiceVersion"};var U=function(a){for(var b in a){var e=b.toLowerCase();var i=T[e];if(i&&b!==i){var p=a[b];delete a[b];a[i]=p;}}};var V=function(a,b){return(a!==u)?a:b;};var W=function(a){return parseInt(a,10);};var X=/^([+-])?P(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)D)?(?:T(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)(?:\.(\d+))?S)?)?/;var Y=function(a){var p=X.exec(a);if(p===null){throw{message:"Invalid duration value."};}var y=p[2]||"0";var b=p[3]||"0";var e=W(p[4]||0);var i=W(p[5]||0);var x=W(p[6]||0);var _=parseFloat(p[7]||0);if(y!=="0"||b!=="0"){throw{message:"Unsupported duration value."};}var _251=p[8];var _252=0;if(!_251){_251=0;}else{if(_251.length>7){throw{message:"Cannot parse duration value to given precision."};}_252=H(_251.substring(3),4,true);_251=H(_251.substring(0,3),3,true);_251=W(_251);_252=W(_252);}_251+=_*1000+x*60000+i*3600000+e*86400000;if(p[1]==="-"){_251=-_251;}var _253={ms:_251,__edmType:"Edm.Time"};if(_252){_253.ns=_252;}return _253;};var Z=function(a){var b=a.substring(0,1);b=(b==="+")?1:-1;var e=W(a.substring(1));var i=W(a.substring(a.indexOf(":")+1));return{d:b,h:e,m:i};};var $=function(a){switch(typeof(a)){case"object":if(!a){return l;}if(K(a)||K(a.results)){return g;}if(a.__metadata&&a.__metadata.uri!==u){return f;}if(K(a.EntitySets)){return j;}if(K(a.__batchRequests)){return P;}if(L(a)){return h;}return c;case"string":case"number":case"boolean":return h;}return k;};var _0=function(a,_36,b){if(!a.method){a.method="GET";}if(!a.headers){a.headers={};}else{U(a.headers);}if(a.headers.Accept===u){a.headers.Accept=_36.accept;}if(t(a.data)&&a.body===u){_36.write(a,b);}if(a.async===u){a.async=true;}};var _1=function(a){switch($(a)){case c:if(a.__deferred&&a.__deferred.uri){return n;}return m;case g:case f:return q;case h:return r;}return s;};var _2=function(e){throw e;};var _3=function(a){if(a.trim){return a.trim();}return a.replace(/^\s+|\s+$/g,'');};var _4=/^([^:\/?#]+:)?(\/\/[^\/?#]*)?([^?#:]+)?(\?[^#]*)?(#.*)?/;var _5=["scheme","authority","path","query","fragment"];var _6=function(a){var b={isAbsolute:false};if(a){var e=_4.exec(a);if(e){var i,p;for(i=0,p=_5.length;i<p;i++){if(e[i+1]){b[_5[i]]=e[i+1];}}}if(b.scheme){b.isAbsolute=true;}}return b;};var _7=function(a){return"".concat(a.scheme||"",a.authority||"",a.path||"",a.query||"",a.fragment||"");};var _8=/^\/{0,2}(?:([^@]*)@)?([^:]+)(?::{1}(\d+))?/;var _9=/%[0-9A-F]{2}/ig;var _10=function(a){var b=_6(a);var e=b.scheme;var i=b.authority;if(e){b.scheme=e.toLowerCase();if(i){var p=_8.exec(i);if(p){b.authority="//"+(p[1]?p[1]+"@":"")+(p[2].toLowerCase())+(p[3]?":"+p[3]:"");}}}a=_7(b);return a.replace(_9,function(x){return x.toLowerCase();});};var _11=function(a,b){if(!b){return a;}var e=_6(a);if(e.isAbsolute){return a;}var i=_6(b);var p={};var x;if(e.authority){p.authority=e.authority;x=e.path;p.query=e.query;}else{if(!e.path){x=i.path;p.query=e.query||i.query;}else{if(e.path.charAt(0)==='/'){x=e.path;}else{x=_12(e.path,i.path);}p.query=e.query;}p.authority=i.authority;}p.path=_13(x);p.scheme=i.scheme;p.fragment=e.fragment;return _7(p);};var _12=function(a,b){var p="/";var e;if(b){e=b.lastIndexOf("/");p=b.substring(0,e);if(p.charAt(p.length-1)!=="/"){p=p+"/";}}return p+a;};var _13=function(p){var a="";var b="";var e;while(p){if(p.indexOf("..")===0||p.indexOf(".")===0){p=p.replace(/^\.\.?\/?/g,"");}else if(p.indexOf("/..")===0){p=p.replace(/^\/\..\/?/g,"/");e=a.lastIndexOf("/");if(e===-1){a="";}else{a=a.substring(0,e);}}else if(p.indexOf("/.")===0){p=p.replace(/^\/\.\/?/g,"/");}else{b=p;e=p.indexOf("/",1);if(e!==-1){b=p.substring(0,e);}a=a+b;p=p.replace(b,"");}}return a;};var _14=0;var _15=function(a){if(a.method&&a.method!=="GET"){return false;}return true;};var _16=function(a){var i=w.document.createElement("IFRAME");i.style.display="none";var b=a.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/\</g,"&lt;");var e="<html><head><script type=\"text/javascript\" src=\""+b+"\"><\/script><\/head><body><\/body><\/html>";var p=w.document.getElementsByTagName("BODY")[0];p.appendChild(i);_23(i,e);return i;};var _17=function(){if(w.XMLHttpRequest){return new w.XMLHttpRequest();}var a;if(w.ActiveXObject){try{return new w.ActiveXObject("Msxml2.XMLHTTP.6.0");}catch(_){try{return new w.ActiveXObject("Msxml2.XMLHTTP.3.0");}catch(e){a=e;}}}else{a={message:"XMLHttpRequest not supported"};}throw a;};var _18=function(a){return a.indexOf("http://")===0||a.indexOf("https://")===0||a.indexOf("file://")===0;};var _19=function(a){if(!_18(a)){return true;}var b=w.location;var e=b.protocol+"//"+b.host+"/";return(a.indexOf(e)===0);};var _20=function(a,b){try{delete w[a];}catch(e){w[a]=u;if(b===_14-1){_14-=1;}}};var _21=function(i){if(i){_23(i,"");i.parentNode.removeChild(i);}return null;};var _22=function(x,a){var b=x.getAllResponseHeaders();if(!b){var _24=x.getResponseHeader("Content-Type");var e=x.getResponseHeader("Content-Length");if(_24)a["Content-Type"]=_24;if(e)a["Content-Length"]=e;}else{b=b.split(/\r?\n/);var i,p;for(i=0,p=b.length;i<p;i++){if(b[i]){var y=b[i].split(": ");a[y[0]]=y[1];}}}};var _23=function(i,a){var b=(i.contentWindow)?i.contentWindow.document:i.contentDocument.document;b.open();b.write(a);b.close();};o.defaultHttpClient={callbackParameterName:"$callback",formatQueryString:"$format=json",enableJsonpCallback:false,request:function(a,b,e){var i={};var x=null;var p=false;var y;i.abort=function(){y=_21(y);if(p){return;}p=true;if(x){x.abort();x=null;}e({message:"Request aborted"});};var _=function(){y=_21(y);if(!p){p=true;x=null;e({message:"Request timed out"});}};var _251;var _252=a.requestUri;var _253=z(a.enableJsonpCallback,this.enableJsonpCallback);var _254=z(a.callbackParameterName,this.callbackParameterName);var _255=z(a.formatQueryString,this.formatQueryString);if(!_253||_19(_252)){x=_17();var _256=function(){if(p||x===null||x.readyState!==4){return;}var _264=x.statusText;var _265=x.status;if(_265===1223){_265=204;_264="No Content";}var _266=[];_22(x,_266);var _267={requestUri:_252,statusCode:_265,statusText:_264,headers:_266,body:x.responseText};p=true;x=null;if(_265>=200&&_265<=299){b(_267);}else{e({message:"HTTP request failed",request:a,response:_267});}};if(a.user&&a.password){x.open(a.method||"GET",_252,a.async,a.user,a.password);}else{x.open(a.method||"GET",_252,a.async);}if(a.headers){for(_251 in a.headers){x.setRequestHeader(_251,a.headers[_251]);}}if(a.timeoutMS){x.timeout=a.timeoutMS;x.ontimeout=_;}if(a.async){x.onreadystatechange=_256;}x.send(a.body);if(!a.async){_256();}}else{if(!_15(a)){throw{message:"Request is not local and cannot be done through JSONP."};}var _257=_14;_14+=1;var _258=_257.toString();var _259=false;var _260;_251="handleJSONP_"+_258;w[_251]=function(_264){y=_21(y);if(!p){_259=true;w.clearTimeout(_260);_20(_251,_257);if(w.ActiveXObject&&!w.DOMParser){_264=w.JSON.parse(w.JSON.stringify(_264));}A(b,{body:_264,statusCode:200,headers:{"Content-Type":"application/json"}});}};var _261=(a.timeoutMS)?a.timeoutMS:120000;_260=w.setTimeout(_,_261);var _262=_254+"=parent."+_251;if(this.formatQueryString){_262+="&"+_255;}var _263=_252.indexOf("?");if(_263===-1){_252=_252+"?"+_262;}else if(_263===_252.length-1){_252=_252+_262;}else{_252=_252+"&"+_262;}y=_16(_252);}return i;}};var _24=function(a){if(!a){return null;}var b=a.split(";");var p={};var i,e;for(i=1,e=b.length;i<e;i++){var x=b[i].split("=");p[_3(x[0])]=x[1];}return{mediaType:_3(b[0]),properties:p};};var _25=function(_24){if(!_24){return u;}var a=_24.mediaType;var p;for(p in _24.properties){a+=";"+p+"="+_24.properties[p];}return a;};var _26=function(_24,a,b,_36){return{contentType:_24,dataServiceVersion:a,metadata:b?b.metadata:null,context:b,handler:_36};};var _27=function(a,b,e){if(!a){return;}var i=a.headers;if(!i[b]){i[b]=e;}};var _28=function(a,b){if(!a.dataServiceVersion){a.dataServiceVersion=b;}};var _29=function(a,b){var e=a.headers;return(e&&e[b])||u;};var _30=function(a){return _24(_29(a,"Content-Type"));};var _31=/^\s?(\d+\.\d+);?.*$/;var _32=function(a){var b=_29(a,"DataServiceVersion");if(b){var e=_31.exec(b);if(e&&e.length){return e[1];}}};var _33=function(_36,a){return _36.accept.indexOf(a.mediaType)>=0;};var _34=function(_36,p,a,b){if(!a||!a.headers){return false;}var e=_30(a);var i=_32(a)||"";var x=a.body;if(!t(x)){return false;}if(_33(_36,e)){var y=_26(e,i,b,_36);y.response=a;a.data=p(_36,x,y);return a.data!==u;}return false;};var _35=function(_36,a,b,e){if(!b||!b.headers){return false;}var i=_30(b);var p=_32(b);if(!i||_33(_36,i)){var x=_26(i,p,e,_36);x.request=b;b.body=a(_36,b.data,x);if(b.body!==u){_27(b,"DataServiceVersion",x.dataServiceVersion||"1.0");_27(b,"Content-Type",_25(x.contentType));return true;}}return false;};var _36=function(p,a,b,e){return{accept:b,maxDataServiceVersion:e,read:function(i,x){return _34(this,p,i,x);},write:function(i,x){return _35(this,a,i,x);}};};var _37=function(_36,b){return b;};var _38=function(_36,a){if(t(a)){return a.toString();}else{return u;}};o.textHandler=_36(_37,_38,"text/plain","2.0");var _39="application/xml";var _40="http://";var _41=_40+"www.w3.org/";var _42=_40+"schemas.microsoft.com/ado/";var _43=_42+"2007/08/dataservices";var _44=_41+"2000/xmlns/";var _45=_41+"XML/1998/namespace";var _46=_42+"2007/06/edmx";var _47=_42+"2008/09/edm";var _48=_42+"2006/04/edm";var _49=_42+"2007/05/edm";var _50=_41+"2005/Atom";var _51=_41+"2007/app";var _52=_43;var _53=_43+"/metadata";var _54=_43+"/related/";var _55=_43+"/scheme";var _56=function(a){var b=/(^\s)|(\s$)/;return b.test(a);};var _57=function(a,x){var b="<c>"+x+"</c>";var p=_82(b,null);var e=a.ownerDocument;var i=p.domNode;if("importNode"in e){i=e.importNode(p.domNode,true);}var y=i.firstChild;while(y){a.appendChild(y);y=y.nextSibling;}};var _58=function(a,b,e){try{a.setProperty(b,e);}catch(_){}};var _59=function(){var a;var b;if(w.ActiveXObject){try{b=new ActiveXObject("Msxml2.DOMDocument.6.0");b.async=false;return b;}catch(_){try{b=new ActiveXObject("Msxml2.DOMDocument.3.0");b.async=false;_58(b,"ProhibitDTD",true);_58(b,"MaxElementDepth",256);_58(b,"AllowDocumentFunction",false);_58(b,"AllowXsltScript",false);return b;}catch(e){a=e;}}}else{if(w.DOMParser){return new w.DOMParser();}a={message:"XML DOM parser not supported"};}throw a;};var _60=function(a){return{name:a.localName,namespace:a.nsURI,value:a.domNode.value};};var _61=function(a){var b={name:a.localName,namespace:a.nsURI,value:_64(a.domNode),attributes:[],children:[]};_69(a,function(e){if(e.nsURI!==_44){b.attributes.push(_60(e));}});_72(a,function(e){b.children.push(_61(e));});return b;};var _62=function(a){var b=/^\s*$/;return a===null||b.test(a);};var _63=function(a){while(a!==null&&a.nodeType===1){var b=_86(a,"space",_45);if(b==="preserve"){return true;}else if(b==="default"){break;}else{a=a.parentNode;}}return false;};var _64=function(a){var b=null;var e=a.firstChild;var i=a.ownerDocument.preserveWhiteSpace===false;var p;while(e){if(e.nodeType===3||e.nodeType===4){var x=e.nodeValue;var y=i||!_62(x);if(!y){if(p===u){p=_63(a);}y=p;}if(y){if(!b){b=x;}else{b+=x;}}}e=e.nextSibling;}return b;};var _65=function(a,b,e){var i;if(a.getElementsByTagNameNS){i=a.getElementsByTagNameNS(b,e);if(i.length!==0){return i[0];}}else{var p=a.firstChild;while(p){if(p.nodeType===1&&_75(p)===e&&p.namespaceURI===b){return p;}p=p.nextSibling;}}return null;};var _66=function(e,a){var p="http://www.mozilla.org/newlayout/xml/parsererror.xml";var b=_89(e,"");if(b.localName==="parsererror"&&b.nsURI===p){var i=_64(e);var x=_65(b,p,"sourcetext");var y=(x)?x.nodeValue:"";throw{message:i,errorXmlText:a,srcText:y};}var _="http://www.w3.org/1999/xhtml";if(b.localName==="h3"&&b.nsURI==_||_65(e,_,"h3")){throw{message:_74(e),errorXmlText:a,srcText:""};}};var _67=function(a,b,e){var i=a.ownerDocument;var p;if(i.createAttributeNS){p=i.createAttributeNS(_44,b);}else{p=i.createNode(2,b,_44);}p.nodeValue=e;a.setAttributeNode(p);};var _68=function(a,b){if(_56(b)){var e=_77(a,"space",_45,"xml");e.value="preserve";}var i=a.ownerDocument.createTextNode(b);a.appendChild(i);};var _69=function(e,a){var b;var p=e.domNode;var i,x;for(i=0,x=p.attributes.length;i<x;i++){b=p.attributes.item(i);a(_89(b));}};var _70=function(e,a,b){return _86(e.domNode,a,b);};var _71=function(a,b,e){var i=a.attributes;if(i.getNamedItemNS){return i.getNamedItemNS(e,b);}return i.getQualifiedItem(b,e);};var _72=function(e,a){var b=e.domNode.firstChild;var i;while(b!==null){if(b.nodeType===1){i=_11(_87(b),e.baseURI);a(_89(b,i));}b=b.nextSibling;}};var _73=function(e){var a=e.domNode.firstChild;var b;while(a!==null){if(a.nodeType===1){b=_11(_87(a),e.baseURI);return _89(a,b);}a=a.nextSibling;}return null;};var _74=function(a){var b=a.text;if(b!==u){return b;}b="";var e=a.firstChild;if(e){do{if(e.nodeType===3||e.nodeType===4){b+=e.nodeValue;}var i=e.firstChild;if(!i){while(e!==a){i=e.nextSibling;if(i){e=i;break;}else{e=e.parentNode;}}}else{e=i;}}while(e!==a);}return b;};var _75=function(a){if(a.localName){return a.localName;}return a.baseName;};var _76=function(a,b){var e;if(w.ActiveXObject){e=_59();e.documentElement=e.createNode(1,a,b);}else if(w.document.implementation&&w.document.implementation.createDocument){e=w.document.implementation.createDocument(b,a,null);}return _89(e.documentElement);};var _77=function(a,b,e,i){var p=a.ownerDocument;var x;b=(i)?(i+":"+b):b;if(p.createAttributeNS){x=p.createAttributeNS(e,b);a.setAttributeNodeNS(x);}else{x=p.createNode(2,b,e||u);a.setAttributeNode(x);}return x;};var _78=function(a,b,e,i){var p=a.ownerDocument;var x;b=(i)?(i+":"+b):b;if(p.createElementNS){x=p.createElementNS(e,b);}else{x=p.createNode(1,b,e||u);}a.appendChild(x);return x;};var _79=function(p,a,b,e){var i=p.domNode.ownerDocument;var x;if(i.createElementNS){x=i.createElementNS(b,a);}else{x=i.createNode(1,a,b||u);}if(e){_68(x,e);}p.domNode.appendChild(x);return _89(x);};var _80=function(e,a,b,i){var p=e.domNode.ownerDocument;var x;if(p.createAttributeNS){x=p.createAttributeNS(b,a);x.value=i;e.domNode.setAttributeNodeNS(x);}else{x=p.createNode(2,a,b||u);x.value=i;e.domNode.setAttributeNode(x);}return _89(x);};var _81=function(a,p){if(p){return p+":"+a;}return a;};var _82=function(a,b){var e=_88(a);var i=_11(_87(e),b);return _89(e,i);};var _83=function(a){var b=a.domNode.ownerDocument;return _85(b);};var _84=function(a){var b=a.childNodes;var i,e=b.length;if(e===0){return"";}var p=a.ownerDocument.createDocumentFragment();for(i=0;i<e;i++){p.appendChild(b[i].cloneNode(true));}return _85(p);};var _85=function(a){var x=a.xml;if(x!==u){return x;}if(w.XMLSerializer){var b=new w.XMLSerializer();return b.serializeToString(a);}throw{message:"XML serialization unsupported"};};var _86=function(a,b,e){if(a.getAttributeNS){return a.getAttributeNS(e||null,b);}var i=a.attributes.getQualifiedItem(b,e);if(i){return i.value;}return null;};var _87=function(a){return _86(a,"base",_45);};var _88=function(a){var b=_59();if(b.parseFromString){b=b.parseFromString(a,"text/xml");_66(b.documentElement,a);}else{b.loadXML(a);if(b.parseError.errorCode!==0){throw{message:b.parseError.reason,errorXmlText:a,srcText:b.parseError.srcText};}}return b.documentElement;};var _89=function(a,b){var e=a.namespaceURI;var i=a.nodeName;if(!e){if(a.nodeType===2&&(i==="xmlns"||i.indexOf("xmlns:",0)===0)){e=_44;}else{e=null;}}return{baseURI:b,domNode:a,localName:_75(a),nsURI:e};};var _90=function(x){if(x.nsURI===_52){switch(x.localName){case"links":return _91(x);case"uri":return _92(x);}}return u;};var _91=function(a){var b=[];_72(a,function(e){if(e.localName==="uri"&&e.nsURI===_52){var i=_92(e);b.push(i);}});return{results:b};};var _92=function(a){return{uri:_74(a.domNode)};};var _93=function(a){if($(a)===c&&!a.__metadata&&a.hasOwnProperty("uri")){return _94(a);}};var _94=function(a){var b=_95(null,"uri",_52);if(a.uri){_68(b.domNode,a.uri);}return b;};var _95=function(p,a,b){if(p){return _79(p,a,b);}return _76(a,b);};var _96=function(_36,a){if(a){var b=_82(a);if(b){return _90(b);}}};var _97=function(_36,a,b){var e=b.contentType=b.contentType||_24(_39);var i=u;if(e&&e.mediaType===_39){var x=_93(a);if(x){i=_83(x);}}return i;};o.xmlHandler=_36(_96,_97,_39,"2.0");var _98=["application/atom+xml","application/atomsvc+xml","application/xml"];var _99=_98[0];var _100=_81("inline","m");var _101=_81("properties","m");var _102=_81("type","m");var _103=_81("null","m");var _104=[_50,_51,_45,_44];var _105={SyndicationAuthorEmail:"author/email",SyndicationAuthorName:"author/name",SyndicationAuthorUri:"author/uri",SyndicationContributorEmail:"contributor/email",SyndicationContributorName:"contributor/name",SyndicationContributorUri:"contributor/uri",SyndicationPublished:"published",SyndicationRights:"rights",SyndicationSummary:"summary",SyndicationTitle:"title",SyndicationUpdated:"updated"};var _106=function(a){return!(v(_104,a));};var _107=function(p){return p;};var _108=function(p){return p==="true";};var _109=/^(-?\d{4,})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?(.*)$/;var _110=function(a,b){var p=_109.exec(a);var e=(p)?I(p[8]):null;if(!p||(!b&&e!=="Z")){throw{message:"Invalid date/time value"};}var y=W(p[1]);if(y<=0){y++;}var i=p[7];var x=0;if(!i){i=0;}else{if(i.length>7){throw{message:"Cannot parse date/time value to given precision."};}x=H(i.substring(3),4,true);i=H(i.substring(0,3),3,true);i=W(i);x=W(x);}var _=W(p[4]);var _251=W(p[5]);var _252=W(p[6]);if(e!=="Z"){var _253=Z(e);var _254=-(_253.d);_+=_253.h*_254;_251+=_253.m*_254;}var _255=new Date();_255.setUTCFullYear(y,W(p[2])-1,W(p[3]));_255.setUTCHours(_,_251,_252,i);if(isNaN(_255.valueOf())){throw{message:"Invalid date/time value"};}if(b){_255.__edmType="Edm.DateTimeOffset";_255.__offset=e;}if(x){_255.__ns=x;}return _255;};var _111=function(p){return _110(p,false);};var _112=function(p){return _110(p,true);};var _113={"Edm.Boolean":_108,"Edm.Binary":_107,"Edm.DateTime":_111,"Edm.DateTimeOffset":_112,"Edm.Time":Y,"Edm.Decimal":_107,"Edm.Guid":_107,"Edm.String":_107,"Edm.Byte":W,"Edm.Double":parseFloat,"Edm.Single":parseFloat,"Edm.Int16":W,"Edm.Int32":W,"Edm.Int64":_107,"Edm.SByte":W};var _114=function(a){return a.toString();};var _115={"Edm.Binary":_114,"Edm.Boolean":_114,"Edm.Byte":_114,"Edm.DateTime":F,"Edm.DateTimeOffset":F,"Edm.Decimal":_114,"Edm.Double":_114,"Edm.Guid":_114,"Edm.Int16":_114,"Edm.Int32":_114,"Edm.Int64":_114,"Edm.SByte":_114,"Edm.Single":_114,"Edm.String":_114,"Edm.Time":G};var _116=function(a){return a&&(_113[a]!==u);};var _117=function(a,b){if(a!==null&&b){var e=_113[b];if(e){a=e(a);}}return a;};var _118=function(a,b){if(a!==null&&b){if(L(a)){b=(C(a))?"Edm.DateTimeOffset":"Edm.DateTime";}var e=_115[b];if(e){a=e(a);}}return a;};var _119=function(a,b){if(a.nsURI===_50){switch(a.localName){case"feed":return _120(a,b);case"entry":return _137(a,b);}}if(a.nsURI===_51&&a.localName==="service"){return _145(a);}};var _120=function(a,b){var e={};var i={results:[],__metadata:e};e.feed_extensions=_124(a);_72(a,function(p){switch(p.nsURI){case _50:switch(p.localName){case"id":e.uri=_11(_74(p.domNode),p.baseURI);e.uri_extensions=_124(p);break;case"title":e.title=_74(p.domNode);e.title_extensions=_124(p);break;case"entry":var x=_137(p,b);i.results.push(x);break;case"link":_121(p,i);break;}return;case _53:if(p.localName==="count"){i.__count=W(_74(p.domNode));return;}break;}var y=_123(p);e.feed_extensions.push(y);});return i;};var _121=function(a,b){var e=_122(a);var i=b.__metadata;switch(e.rel){case"next":b.__next=e.href;i.next_extensions=e.extensions;break;case"self":i.self=e.href;i.self_extensions=e.extensions;break;}};var _122=function(a){var b={extensions:[]};var e;_69(a,function(i){if(!i.nsURI){switch(i.localName){case"href":b.href=_11(i.domNode.nodeValue,a.baseURI);return;case"type":case"rel":b[i.localName]=i.domNode.nodeValue;return;}}if(_106(i.nsURI)){e=_125(i);b.extensions.push(e);}});if(!b.href){throw{error:"href attribute missing on link element",element:a};}return b;};var _123=function(a){var e={name:a.localName,namespaceURI:a.nsURI,attributes:_124(a),children:[]};_72(a,function(i){var p=_123(i);e.children.push(p);});if(e.children.length===0){var b=_74(a.domNode);if(b){e.value=b;}}return e;};var _124=function(x){var e=[];_69(x,function(a){if(_106(a.nsURI)){var b=_125(a);e.push(b);}});return e;};var _125=function(a){return{name:a.localName,namespaceURI:a.nsURI,value:a.domNode.nodeValue};};var _126=function(p,a){if(p.indexOf('/')===-1){return a[p];}else{var b=p.split('/');var i,e;for(i=0,e=b.length;i<e;i++){if(a===null){return u;}a=a[b[i]];if(a===u){return a;}}return a;}};var _127=function(p,a,b,e){var x;if(p.indexOf('/')===-1){a[p]=b;x=p;}else{var y=p.split('/');var i,_;for(i=0,_=(y.length-1);i<_;i++){var _251=a[y[i]];if(_251===u){_251={};a[y[i]]=_251;}else if(_251===null){return;}a=_251;}x=y[i];a[x]=b;}if(e){var _252=a.__metadata=a.__metadata||{};var _253=_252.properties=_252.properties||{};var _254=_253[x]=_253[x]||{};_254.type=e;}};var _128=function(p){return _105[p]||p;};var _129=function(a,x,e,b){var p=x.split('/');var i,y;for(i=0,y=p.length;i<y;i++){if(p[i].charAt(0)==="@"){return _86(e,p[i].substring(1),a);}else{e=_65(e,a,p[i]);if(!e){return u;}}}if(b){return _84(e);}else{return _74(e);}};var _130=function(a,b,x,e,p,y){var _=e;var _251=x.split('/');var i,_252;for(i=0,_252=_251.length;i<_252;i++){var _253;if(_251[i].charAt(0)==="@"){_253=_71(_,_251[i].substring(1),a);if(!_253){_253=_77(_,_251[i].substring(1),a,b);}}else{_253=_65(_,a,_251[i]);if(!_253){_253=_78(_,_251[i],a,b);}}_=_253;}if(_.nodeType===2){_.value=y;}else{if(p){_.setAttribute("type",p);}if(p==="xhtml"){_57(_,y);}else{_68(_,y);}}};var _131=function(e){if(e.childNodes.length){return false;}var a=e.attributes;var b=a.length;if(b===0){return true;}for(var i=0;i<b;i++){var p=a[i].nodeName;if(p!=="xmlns"&&p.indexOf("xmlns:")!==0&&p!=="m:type"){return false;}}return true;};var _132=function(e,p){var a=_65(e.domNode,_53,"properties");if(!a){var b=_65(e.domNode,_50,"content");if(b){a=_65(b,_53,"properties");}}if(a){var x=a;var y=p.split("/");var i,_;for(i=0,_=(y.length-1);i<_;i++){x=_65(x,_52,y[i]);if(!x){return;}}var _251=_65(x,_52,y[i]);if(_251){x.removeChild(_251);}var _252=x;while(_252!==a&&_131(_252)){var _253=_252.parentNode;_253.removeChild(_252);_252=_253;}}};var _133=function(a,b,e,i,p,x,y){var _=a["FC_TargetPath"+x];var _251=_128(_);var _252=(_!==_251)?_50:a["FC_NsUri"+x];var _253=(a["FC_KeepInContent"+x]==="true")?true:false;var _254=a["FC_ContentKind"+x];var _255=a["FC_NsPrefix"+x]||null;var _256=_126(b,i);if(!t(_256)){return;}if(!_253){y.dataServiceVersion="2.0";_132(e,b);}_256=_118(_256,p);_130(_252,_255,_251,e.domNode,_254,_256);};var _134=function(a,b,e,i,p,x){if(a["FC_KeepInContent"+x]==="true"){return;}if(_126(b,i)===null){return;}var y=a["FC_TargetPath"+x];var _=_128(y);var _251=(y!==_)?_50:a["FC_NsUri"+x];var _252=(a["FC_ContentKind"+x]==="xhtml");var _253=_129(_251,_,e.domNode,_252);if(_253===u){return;}_253=_117(_253,p);_127(b,i,_253,p);};var _135=function(a,e,p){var b=p.split("/");var i,x;while(e){var y=e;for(i=0,x=b.length;i<x;i++){var _=y.property;if(!_){break;}var _251=M(_,b[i]);if(!_251){break;}var _252=_251.type;if(!_252||_116(_252)){return _252||null;}y=O(_252,a);if(!y){return null;}}e=Q(e.baseType,a);}return null;};var _136=function(e,a,b){if(!b||b.length===0){return;}var p=a.__metadata.type;while(p){var x=Q(p,b);if(!x){return;}var y;var _=x.FC_SourcePath;if(_){y=_135(b,x,_);_134(x,_,e,a,y,"");}var _251=x.property;if(_251){var i,_252;for(i=0,_252=_251.length;i<_252;i++){var _253=_251[i];var _254=0;var _255="";while(_253["FC_TargetPath"+_255]){_=_253.name;y=_253.type;var _256=_253["FC_SourcePath"+_255];if(_256){_+="/"+_256;y=_135(b,x,_);}_134(_253,_,e,a,y,_255);_254++;_255="_"+_254;}}}p=x.baseType;}};var _137=function(a,b){var e={};var i={__metadata:e};var p=_70(a,"etag",_53);if(p){e.etag=p;}_72(a,function(x){if(x.nsURI===_50){switch(x.localName){case"id":e.uri=_11(_74(x.domNode),x.baseURI);e.uri_extensions=_124(x);break;case"category":_138(x,i,e);break;case"content":_139(x,i);break;case"link":_141(x,i,b);break;}}if(x.nsURI===_53&&x.localName==="properties"){_143(x,i,e);}});_136(a,i,b);return i;};var _138=function(a,e,b){var i=_70(a,"scheme");var p=_70(a,"term");if(i===_55){if(e.__metadata.type){throw{message:"Invalid AtomPub document: multiple category elements defining the entry type were encounterd withing an entry",element:a};}b.type=p;b.type_extensions=[];var x;_69(a,function(y){if(!y.nsURI){if(y.localName!=="scheme"&&y.localName!=="term"){x=_125(y);b.type_extensions.push(x);}}else if(_106(y.nsURI)){x=_125(y);b.type_extensions.push(x);}});}};var _139=function(a,e){var b=_70(a,"src");var i=_70(a,"type");var p=e.__metadata;if(b){if(!i){throw{message:"Invalid AtomPub document: content element must specify the type attribute if the src attribute is also specified",element:a};}p.media_src=_11(b,a.baseURI);p.content_type=i;}_72(a,function(x){if(b){throw{message:"Invalid AtomPub document: content element must not have child elements if the src attribute is specified",element:a};}if(x.nsURI===_53&&x.localName==="properties"){_143(x,e,p);}});};var _140=function(a,e,b){b.edit_media=a.href;b.edit_media_extensions=[];var i,p;for(i=0,p=a.extensions.length;i<p;i++){if(a.extensions[i].namespaceURI===_53&&a.extensions[i].name==="etag"){b.media_etag=a.extensions[i].value;}else{b.edit_media_extensions.push(a.extensions[i]);}}};var _141=function(a,e,b){var i=_122(a);var p=e.__metadata;switch(i.rel){case"self":p.self=i.href;p.self_link_extensions=i.extensions;break;case"edit":p.edit=i.href;p.edit_link_extensions=i.extensions;break;case"edit-media":_140(i,e,p);break;default:if(i.rel.indexOf(_54)===0){_142(a,i,e,b);}break;}};var _142=function(a,b,e,i){var p=b.rel.substring(_54.length);var x=u;_72(a,function(y){if(y.nsURI===_53&&y.localName==="inline"){var _=_73(y);if(_){x=_119(_,i);}else{x=null;}}});if(x===u){x={__deferred:{uri:b.href}};}e[p]=x;e.__metadata.properties=e.__metadata.properties||{};e.__metadata.properties[p]={extensions:b.extensions};};var _143=function(p,a,b){_72(p,function(e){if(e.nsURI===_52){b.properties=b.properties||{};_144(e,a,b.properties);}});};var _144=function(p,a,b){var e=null;var i="Edm.String";var x=[];_69(p,function(_251){if(_251.nsURI===_53){switch(_251.localName){case"null":e=_251.domNode.nodeValue;return;case"type":i=_251.domNode.nodeValue;return;};}if(_106(_251.nsURI)){var _252=_125(_251);x.push(_252);}});var y=null;var _={type:i,extensions:x};if(e!=="true"){y=_74(p.domNode);if(_116(i)){y=_117(y,i);}else{if(_73(p)){y={__metadata:{type:i}};_143(p,y,_);}}}a[p.localName]=y;b[p.localName]=_;};var _145=function(a){var b={workspaces:[],extensions:[]};_72(a,function(e){if(e.nsURI===_51&&e.localName==="workspace"){var i=_146(e);b.workspaces.push(i);}else{var p=_123(a);b.extensions.push(p);}});if(b.workspaces.length===0){throw{message:"Invalid AtomPub service document: No workspace element found.",element:a};}return b;};var _146=function(a){var b={collections:[],extensions:[]};_72(a,function(e){if(e.nsURI===_50){if(e.localName==="title"){if(a.title){throw{message:"Invalid AtomPub service document: workspace has more than one child title element",element:e};}b.title=_74(e.domNode);}}else if(e.nsURI===_51){if(e.localName==="collection"){var i=_147(e,b);b.collections.push(i);}}else{var p=_123(a);b.extensions.push(p);}});b.title=b.title||"";return b;};var _147=function(a){var b={href:_70(a,"href"),extensions:[]};if(!b.href){throw{message:"Invalid AtomPub service document: collection has no href attribute",element:a};}b.href=_11(b.href,a.baseURI);_72(a,function(e){if(e.nsURI===_50){if(e.localName==="title"){if(b.title){throw{message:"Invalid AtomPub service document: collection has more than one child title element",element:e};}b.title=_74(e.domNode);}}else if(e.nsURI!==_51){var i=_123(a);b.extensions.push(i);}});if(!b.title){throw{message:"Invalid AtomPub service document: collection has no title element",element:a};}return b;};var _148=function(a,b){var e;var i=$(a);switch(i){case g:e=_150(null,a,b);break;case f:case c:e=_151(null,a,b);break;}return e;};var _149=function(p,a){if(p){return _79(p,a,_50);}var b=_76(a,_50);_67(b.domNode,"xmlns:d",_52);_67(b.domNode,"xmlns:m",_53);return b;};var _150=function(p,a,b){var e=_149(p,"feed");var x=(K(a))?a:a.results;if(x){var i,y;for(i=0,y=x.length;i<y;i++){_151(e,x[i],b);}}return e;};var _151=function(p,a,b){var e=_149(p,"entry");var i=_79(e,"author",_50);_79(i,"name",_50);_79(e,"title",_50);var x=_79(e,"content",_50);_80(x,"type",null,"application/xml");var y=_79(x,_101,_53);var _=(a.__metadata)?a.__metadata.properties:null;_153(e,a.__metadata);_155(e,y,a,_,b);_152(e,a,b);return e;};var _152=function(e,a,b){if(!a.__metadata){return;}var p=b.metadata;var x=Q(a.__metadata.type,p);while(x){var y;var _=x.FC_SourcePath;if(_){y=_135(p,x,_);_133(x,_,e,a,y,"",b);}var _251=x.property;if(_251){var i,_252;for(i=0,_252=_251.length;i<_252;i++){var _253=_251[i];var _254=0;var _255="";while(_253["FC_TargetPath"+_255]){_=_253.name;if(_253["FC_SourcePath"+_255]){_+="/"+_253["FC_SourcePath"+_255];}_133(_253,_,e,a,_253.type,_255,b);_254++;_255="_"+_254;}}}x=Q(x.baseType,p);}};var _153=function(e,a){if(a){if(a.etag){_80(e,"etag",_53,a.etag);}if(a.uri){_79(e,"id",_50,a.uri);}if(a.type){var b=_79(e,"category",_50);_80(b,"term",null,a.type);_80(b,"scheme",null,_55);}}};var _154=function(e,a,b){var i=_79(e,"link",_50);_80(i,"rel",null,b);_80(i,"href",null,a);return i;};var _155=function(e,p,a,b,i){var x,y,_,_251;var _252=i.metadata;var _253;for(x in a){if(x!=="__metadata"){y=a[x];_=_1(y);_251=(b)?b[x]:null;if(!_251){if(_253===u){if(a.__metadata){_253=Q(a.__metadata.type,_252);}}if(_253){_251=M(_253.property,x);if(!_251){_251=M(_253.navigationProperty,x);}}}if(_===s){_=r;if(_251&&!_116(_251.type)){if(_251.relationship){_=q;}else if(O(_251.type,i.metadata)){_=m;}}}if(_===r||_===m){_156(p,x,_,y,_251,i);}else{_157(e,_,x,y,i);}}}};var _156=function(p,a,b,e,i,x){var y=_81(a,"d");var _=i&&i.type;var _251;if(b===m){_251=_79(p,y,_52);var _252;if(i){_252=i.properties;}if(e===null){x.dataServiceVersion="2.0";}_155(null,_251,e,_252,x);}else{_251=_79(p,y,_52,_118(e,_||"Edm.String"));}if(e===null){_80(_251,_103,_53,"true");}if(_){_80(_251,_102,_53,_);}};var _157=function(e,a,b,i,p){var x;var y;var _;var _251=a===q;if(_251){x=(i&&i.__metadata)?i.__metadata.uri:"";_=$(i);switch(_){case f:y=_151;break;case g:_="feed";y=_150;break;case l:_=f;y=null;break;default:throw{message:"Invalid payload for inline navigation property: "+_};}}else{x=i.__deferred.uri;}var _252=_11(b,_54);var _253=_154(e,x,_252);if(_251){var _254=_79(_253,_100,_53);_80(_253,"type",null,"application/atom+xml;type="+_);if(y){y(_254,i,p);}}};var _158=function(_36,a,b){if(a){var e=_82(a);if(e){return _119(e,b.metadata);}}};var _159=function(_36,a,b){var e=b.contentType=b.contentType||_24(_99);var i=u;if(e&&e.mediaType===_99){var p=_148(a,b);i=_83(p);}return i;};o.atomHandler=_36(_158,_159,_98.join(","),"2.0");var _160={elements:{Association:{attributes:["Name"],elements:["End*","ReferentialConstraint"]},AssociationSet:{attributes:["Name","Association"],elements:["End*"]},CollectionType:{attributes:["ElementType","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation"]},ComplexType:{attributes:["Name","BaseType","Abstract"],elements:["Property*"]},DefiningExpression:{text:true},Dependent:{attributes:["Role"],elements:["PropertyRef*"]},Documentation:{text:true},End:{attributes:["Type","Role","Multiplicity","EntitySet"],elements:["OnDelete"]},EntityContainer:{attributes:["Name","Extends"],elements:["EntitySet*","AssociationSet*","FunctionImport*"]},EntitySet:{attributes:["Name","EntityType"]},EntityType:{attributes:["Name","BaseType","Abstract","OpenType"],elements:["Key","Property*","NavigationProperty*"]},Function:{attributes:["Name","ReturnType"],elements:["Parameter*","DefiningExpression","ReturnType"]},FunctionImport:{attributes:["Name","ReturnType","EntitySet"],elements:["Parameter*"]},Key:{elements:["PropertyRef*"]},NavigationProperty:{attributes:["Name","Relationship","ToRole","FromRole"]},OnDelete:{attributes:["Action"]},Parameter:{attributes:["Name","Type","Mode","MaxLength","Precision","Scale"]},Principal:{attributes:["Role"],elements:["PropertyRef*"]},Property:{attributes:["Name","Type","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","ConcurrencyMode"]},PropertyRef:{attributes:["Name"]},ReferenceType:{attributes:["Type"]},ReferentialConstraint:{elements:["Principal","Dependent"]},ReturnType:{attributes:["ReturnType"],elements:["CollectionType","ReferenceType","RowType"]},RowType:{elements:["Property*"]},Schema:{attributes:["Namespace","Alias"],elements:["Using*","EntityContainer*","EntityType*","Association*","ComplexType*","Function*"]},TypeRef:{attributes:["Type","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation"]},Using:{attributes:["Namespace","Alias"]}}};var _161=["m:FC_ContentKind","m:FC_KeepInContent","m:FC_NsPrefix","m:FC_NsUri","m:FC_SourcePath","m:FC_TargetPath"];_160.elements.Property.attributes=_160.elements.Property.attributes.concat(_161);_160.elements.EntityType.attributes=_160.elements.EntityType.attributes.concat(_161);_160.elements.Edmx={attributes:["Version"],elements:["DataServices"],ns:_46};_160.elements.DataServices={elements:["Schema*"],ns:_46};_160.elements.EntityContainer.attributes.push("m:IsDefaultEntityContainer");_160.elements.Property.attributes.push("m:MimeType");_160.elements.FunctionImport.attributes.push("m:HttpMethod");_160.elements.EntityType.attributes.push("m:HasStream");_160.elements.DataServices.attributes=["m:DataServiceVersion"];var _162=function(a){if(!a){return a;}if(a.length>1){var b=a.substr(0,2);if(b===b.toUpperCase()){return a;}return a.charAt(0).toLowerCase()+a.substr(1);}return a.charAt(0).toLowerCase();};var _163=function(p,a){if(a==="Documentation"){return{isArray:true,propertyName:"documentation"};}var e=p.elements;if(!e){return null;}var i,b;for(i=0,b=e.length;i<b;i++){var x=e[i];var y=false;if(x.charAt(x.length-1)==="*"){y=true;x=x.substr(0,x.length-1);}if(a===x){var _=_162(x);return{isArray:y,propertyName:_};}}return null;};var _164=/^(m:FC_.*)_[0-9]+$/;var _165=function(a){return a===_47||a===_48||a===_49;};var _166=function(e){if(!e.domNode){e=_89(e,"");}var a=e.localName;var b=_160.elements[a];if(!b){return null;}if(b.ns){if(e.nsURI!==b.ns){return null;}}else if(!_165(e.nsURI)){return null;}var i={};var p=[];var x=b.attributes||[];_69(e,function(y){var _=y.domNode;var a=y.localName;var _251=y.nsURI;var _252=_.value;if(_251===_44){return;}var _253=null;var _254=false;if(_165(_251)||_251===null){_253="";}else if(_251===_53){_253="m:";}if(_253!==null){_253+=a;var _255=_164.exec(_253);if(_255){_253=_255[1];}if(v(x,_253)){_254=true;i[_162(a)]=_252;}}if(!_254){p.push(_60(y));}});_72(e,function(y){var _=_163(b,y.localName);if(_){if(_.isArray){var _251=i[_.propertyName];if(!_251){_251=[];i[_.propertyName]=_251;}_251.push(_166(y));}else{i[_.propertyName]=_166(y);}}else{p.push(_61(y));}});if(b.text){i.text=_74(e);}if(p.length){i.extensions=p;}return i;};var _167=function(_36,a){var b=_82(a);return _166(b)||u;};o.metadataHandler=_36(_167,null,_39,"1.0");var _168="application/json";var _169=function(a,b){var e={collections:[]};var i,p;for(i=0,p=a.EntitySets.length;i<p;i++){var x=a.EntitySets[i];var y={title:x,href:_11(x,b)};e.collections.push(y);}return{workspaces:[e]};};var _170=/^\/Date\((-?\d+)(\+|-)?(\d+)?\)\/$/;var _171=function(a){var b;if(a<0){b="-";a=-a;}else{b="+";}var e=Math.floor(a/60);a=a-(60*e);return b+H(e,2)+":"+H(a,2);};var _172=function(a){var b=a&&_170.exec(a);if(b){var e=new Date(W(b[1]));if(b[2]){var i=W(b[3]);if(b[2]==="-"){i=-i;}var p=e.getUTCMinutes();e.setUTCMinutes(p-i);e.__edmType="Edm.DateTimeOffset";e.__offset=_171(i);}if(!isNaN(e.valueOf())){return e;}}};var _173=function(i,a){if(i&&typeof i==="object"){for(var b in i){var e=i[b];var p=_173(e,a);p=a(b,p);if(p!==e){if(e===u){delete i[b];}else{i[b]=p;}}}}return i;};var _174=function(i,a){return a("",_173(i,a));};var _175=function(_36,a,b){var e=b.metadata;var p=z(b.context?b.context.recognizeDates:u,_36.recognizeDates);var x=(typeof a==="string")?w.JSON.parse(a):a;x=_174(x,function(_,y){if(y&&typeof y==="object"){var _251=y.__metadata&&y.__metadata.type;var _252=Q(_251,e)||O(_251,e);if(_252){var _253=_252.property;if(_253){var i,_254;for(i=0,_254=_253.length;i<_254;i++){var _255=_253[i];var _256=_255.name;var _257=y[_256];if(_255.type==="Edm.DateTime"||_255.type==="Edm.DateTimeOffset"){if(_257){_257=_172(_257);if(!_257){throw{message:"Invalid date/time value"};}y[_256]=_257;}}else if(_255.type==="Edm.Time"){y[_256]=Y(_257);}}}}else if(p){for(var _258 in y){_257=y[_258];if(typeof _257==="string"){y[_258]=_172(_257)||_257;}}}}return y;}).d;x=_179(x,b.dataServiceVersion);x=_178(x,b.response.requestUri);return x;};var _176=function(_36,a,b){var e=u;var i=b.contentType=b.contentType||_24(_168);if(i&&i.mediaType===_168){var p=a;var x=Date.prototype.toJSON;try{Date.prototype.toJSON=function(){return E(this);};e=w.JSON.stringify(p,_177);e=e.replace(/\/Date\(([0-9.+-]+)\)\//g,"\\/Date($1)\\/");}finally{Date.prototype.toJSON=x;}}return e;};var _177=function(_,a){if(a&&a.__edmType==="Edm.Time"){return G(a);}else{return a;}};var _178=function(a,b){if($(a)===j){return _169(a,b);}else{return a;}};var _179=function(a,b){if(b&&b.lastIndexOf(";")===b.length-1){b=b.substr(0,b.length-1);}if(!b){if(K(a)){b="1.0";}}if(b==="2.0"){return a;}if(b==="1.0"){if(K(a)){a={results:a};}}return a;};o.jsonHandler=_36(_175,_176,_168,"2.0");o.jsonHandler.recognizeDates=false;var _180="multipart/mixed";var _181=/^HTTP\/1\.\d (\d{3}) (.*)$/i;var _182=/^([^()<>@,;:\\"\/[\]?={} \t]+)\s?:\s?(.*)/;var _183=function(){return Math.floor((1+Math.random())*0x10000).toString(16).substr(1);};var _184=function(p){return p+_183()+"-"+_183()+"-"+_183();};var _185=function(a){return a.handler.partHandler;};var _186=function(a){var b=a.boundaries;return b[b.length-1];};var _187=function(_36,a,b){var e=b.contentType.properties["boundary"];return{__batchResponses:_189(a,{boundaries:[e],handlerContext:b})};};var _188=function(_36,a,b){var e=b.contentType=b.contentType||_24(_180);if(e.mediaType===_180){return _194(a,b);}};var _189=function(a,b){var i="--"+_186(b);_193(a,b,i);_192(a,b);var p=[];var x;while(x!=="--"&&b.position<a.length){var y=_190(a,b);var _=_24(y["Content-Type"]);if(_&&_.mediaType===_180){b.boundaries.push(_.properties["boundary"]);try{var _251=_189(a,b);}catch(e){e.response=_191(a,b,i);_251=[e];}p.push({__changeResponses:_251});b.boundaries.pop();_193(a,b,"--"+_186(b));}else{if(!_||_.mediaType!=="application/http"){throw{message:"invalid MIME part type "};}_192(a,b);var _252=_191(a,b,i);try{if(_252.statusCode>=200&&_252.statusCode<=299){_185(b.handlerContext).read(_252,b.handlerContext);}else{_252={message:"HTTP request failed",response:_252};}}catch(e){_252=e;}p.push(_252);}x=a.substr(b.position,2);_192(a,b);}return p;};var _190=function(a,b){var e={};var p;var i;var x;do{x=b.position;i=_192(a,b);p=_182.exec(i);if(p!==null){e[p[1]]=p[2];}else{b.position=x;}}while(i&&p);U(e);return e;};var _191=function(a,b,e){var p=b.position;var i=_181.exec(_192(a,b));var x;var y;var _;if(i){x=i[1];y=i[2];_=_190(a,b);_192(a,b);}else{b.position=p;}return{statusCode:x,statusText:y,headers:_,body:_193(a,b,e)};};var _192=function(a,b){return _193(a,b,"\r\n");};var _193=function(a,b,e){var i=b.position||0;var p=a.length;if(e){p=a.indexOf(e,i);if(p===-1){return null;}b.position=p+e.length;}else{b.position=p;}return a.substring(i,p);};var _194=function(a,b){var e=$(a);if(e!==P){throw{message:"Serialization of batches of type \""+e+"\" is not supported"};}var p=_184("batch_");var x=a.__batchRequests;var y="";var i,_;for(i=0,_=x.length;i<_;i++){y+=_195(p,false)+_196(x[i],b);}y+=_195(p,true);var _251=b.contentType.properties;_251.boundary=p;return y;};var _195=function(b,a){var e="\r\n--"+b;if(a){e+="--";}return e+"\r\n";};var _196=function(p,a,b){var e=p.__changeRequests;var x;if(K(e)){if(b){throw{message:"Not Supported: change set nested in other change set"};}var y=_184("changeset_");x="Content-Type: "+_180+"; boundary="+y+"\r\n";var i,_;for(i=0,_=e.length;i<_;i++){x+=_195(y,false)+_196(e[i],a,true);}x+=_195(y,true);}else{x="Content-Type: application/http\r\nContent-Transfer-Encoding: binary\r\n\r\n";_0(p,_185(a),{metadata:a.metadata});x+=_197(p);}return x;};var _197=function(a){var b=(a.method?a.method:"GET")+" "+a.requestUri+" HTTP/1.1\r\n";for(var e in a.headers){if(a.headers[e]){b=b+e+": "+a.headers[e]+"\r\n";}}b+="\r\n";if(a.body){b+=a.body;}return b;};o.batchHandler=_36(_187,_188,_180,"1.0");var _198=[o.jsonHandler,o.atomHandler,o.xmlHandler,o.textHandler];var _199=function(a,b,e){var i,p;for(i=0,p=_198.length;i<p&&!_198[i][a](b,e);i++){}if(i===p){throw{message:"no handler for data"};}};o.defaultSuccess=function(a){w.alert(w.JSON.stringify(a));};o.defaultError=_2;o.defaultHandler={read:function(a,b){if(a&&t(a.body)&&a.headers["Content-Type"]){_199("read",a,b);}},write:function(a,b){_199("write",a,b);},accept:"application/atomsvc+xml;q=0.8, application/json;q=0.5, */*;q=0.1"};o.defaultMetadata=[];o.read=function(a,b,e,_36,i,p){var x;if(a instanceof String||typeof a==="string"){x={requestUri:a};}else{x=a;}return o.request(x,b,e,_36,i,p);};o.request=function(a,b,e,_36,i,p){if(!b){b=o.defaultSuccess;}if(!e){e=o.defaultError;}if(!_36){_36=o.defaultHandler;}if(!i){i=o.defaultHttpClient;}if(!p){p=o.defaultMetadata;}a.recognizeDates=z(a.recognizeDates,o.jsonHandler.recognizeDates);a.callbackParameterName=z(a.callbackParameterName,o.defaultHttpClient.callbackParameterName);a.formatQueryString=z(a.formatQueryString,o.defaultHttpClient.formatQueryString);a.enableJsonpCallback=z(a.enableJsonpCallback,o.defaultHttpClient.enableJsonpCallback);var x={metadata:p,recognizeDates:a.recognizeDates,callbackParameterName:a.callbackParameterName,formatQueryString:a.formatQueryString,enableJsonpCallback:a.enableJsonpCallback};try{_0(a,_36,x);return J(a,b,e,_36,i,x);}catch(y){e(y);}};o.batchHandler.partHandler=o.defaultHandler;var _200=w.localStorage;var _201=function(){var a={v:this.valueOf(),t:"[object Date]"};for(var b in this){a[b]=this[b];}return a;};var _202=function(_,a){if(a&&a.t==="[object Date]"){var b=new Date(a.v);for(var e in a){if(e!=="t"&&e!=="v"){b[e]=a[e];}}a=b;}return a;};var _203=function(a,b){return a.name+"#!#"+b;};var _204=function(a,b){return b.replace(a.name+"#!#","");};var _205=function(a){this.name=a;};_205.create=function(a){if(_205.isSupported()){return new _205(a);}throw{message:"Web Storage not supported by the browser"};};_205.isSupported=function(){return!!_200;};_205.prototype.add=function(a,b,e,i){i=i||this.defaultError;var p=this;this.contains(a,function(x){if(!x){p.addOrUpdate(a,b,e,i);}else{A(i,{message:"key already exists",key:a});}},i);};_205.prototype.addOrUpdate=function(a,b,i,p){p=p||this.defaultError;if(a instanceof Array){p({message:"Array of keys not supported"});}else{var x=_203(this,a);var y=Date.prototype.toJSON;try{var _=b;if(_!==u){Date.prototype.toJSON=_201;_=w.JSON.stringify(b);}_200.setItem(x,_);A(i,a,b);}catch(e){if(e.code===22||e.number===0x8007000E){A(p,{name:"QUOTA_EXCEEDED_ERR",error:e});}else{A(p,e);}}finally{Date.prototype.toJSON=y;}}};_205.prototype.clear=function(a,b){b=b||this.defaultError;try{var i=0,p=_200.length;while(p>0&&i<p){var x=_200.key(i);var y=_204(this,x);if(x!==y){_200.removeItem(x);p=_200.length;}else{i++;}};A(a);}catch(e){A(b,e);}};_205.prototype.close=function(){};_205.prototype.contains=function(a,b,i){i=i||this.defaultError;try{var p=_203(this,a);var x=_200.getItem(p);A(b,x!==null);}catch(e){A(i,e);}};_205.prototype.defaultError=_2;_205.prototype.getAllKeys=function(a,b){b=b||this.defaultError;var p=[];var i,x;try{for(i=0,x=_200.length;i<x;i++){var y=_200.key(i);var _=_204(this,y);if(y!==_){p.push(_);}}A(a,p);}catch(e){A(b,e);}};_205.prototype.mechanism="dom";_205.prototype.read=function(a,b,i){i=i||this.defaultError;if(a instanceof Array){i({message:"Array of keys not supported"});}else{try{var p=_203(this,a);var x=_200.getItem(p);if(x!==null&&x!=="undefined"){x=w.JSON.parse(x,_202);}else{x=u;}A(b,a,x);}catch(e){A(i,e);}}};_205.prototype.remove=function(a,b,i){i=i||this.defaultError;if(a instanceof Array){i({message:"Batches not supported"});}else{try{var p=_203(this,a);_200.removeItem(p);A(b);}catch(e){A(i,e);}}};_205.prototype.update=function(a,b,e,i){i=i||this.defaultError;var p=this;this.contains(a,function(x){if(x){p.addOrUpdate(a,b,e,i);}else{A(i,{message:"key not found",key:a});}},i);};var _206=w.mozIndexedDB;var _207=w.IDBTransaction;var _208=w.IDBKeyRange;var _209=function(a,b){return function(e){if(e.code===11){e={name:"QUOTA_EXCEEDED_ERR",error:e};}if(a){a(e);}else if(b){b(e);}};};var _210=function(a,b,e,i){var p=a.name;var x=a.db;var y=_209(i,a.defaultError);if(x){e(x.transaction(p,b));}else{var _=_206.open("_datajs_"+p);_.onsuccess=function(_251){x=a.db=_251.target.result;if(!x.objectStoreNames.contains(p)){var _252=x.setVersion("1.0");_252.onsuccess=function(){x.createObjectStore(p,null,false);e(x.transaction(p,b));};_252.onerror=y;_252.onblocked=y;}else{e(x.transaction(p,b));}};_.onerror=_209(i,this.defaultError);}};var _211=function(a){this.name=a;};_211.create=function(a){if(_211.isSupported()){return new _211(a);}throw{message:"IndexedDB is not supported on this browser"};};_211.isSupported=function(){return!!_206;};_211.prototype.add=function(a,b,e,p){var x=this.name;var y=this.defaultError;var _=[];var _251=[];if(a instanceof Array){_=a;_251=b;}else{_=[a];_251=[b];}_210(this,_207.READ_WRITE,function(_252){_252.onabort=_209(p,y);_252.oncomplete=function(){if(a instanceof Array){e(_,_251);}else{e(a,b);}};for(var i=0;i<_.length&&i<_251.length;i++){_252.objectStore(x).add(_251[i],_[i]);}},p);};_211.prototype.addOrUpdate=function(a,b,e,p){var x=this.name;var y=this.defaultError;var _=[];var _251=[];if(a instanceof Array){_=a;_251=b;}else{_=[a];_251=[b];}_210(this,_207.READ_WRITE,function(_252){_252.onabort=_209(p,y);_252.oncomplete=function(){if(a instanceof Array){e(_,_251);}else{e(a,b);}};for(var i=0;i<_.length&&i<_251.length;i++){_252.objectStore(x).put(_251[i],_[i]);}},p);};_211.prototype.clear=function(a,e){var b=this.name;var i=this.defaultError;_210(this,_207.READ_WRITE,function(p){p.onerror=_209(e,i);p.oncomplete=function(){a();};p.objectStore(b).clear();},e);};_211.prototype.close=function(){if(this.db){this.db.close();this.db=null;}};_211.prototype.contains=function(a,b,e){var i=this.name;var p=this.defaultError;_210(this,_207.READ_ONLY,function(x){var y=x.objectStore(i).openCursor(_208.only(a));x.oncomplete=function(){b(y.result!==u);};x.onerror=_209(e,p);},e);};_211.prototype.defaultError=_2;_211.prototype.getAllKeys=function(a,e){var b=this.name;var i=this.defaultError;_210(this,_207.READ_ONLY,function(p){var x=[];p.oncomplete=function(){a(x);};var y=p.objectStore(b).openCursor();y.onerror=_209(e,i);y.onsuccess=function(_){var _251=_.target.result;if(_251){x.push(_251.key);_251["continue"].call(_251);}};},e);};_211.prototype.mechanism="indexeddb";_211.prototype.read=function(a,b,e){var p=this.name;var x=this.defaultError;var y=(a instanceof Array)?a:[a];_210(this,_207.READ_WRITE,function(_){var _251=[];_.onerror=_209(e,x);_.oncomplete=function(){if(a instanceof Array){b(y,_251);}else{b(y[0],_251[0]);}};for(var i=0;i<y.length;i++){var _252=_.objectStore(p);var _253=_252["get"].call(_252,y[i]);_253.onsuccess=function(_254){_251.push(_254.target.result);};}},e);};_211.prototype.remove=function(a,b,e){var p=this.name;var x=this.defaultError;var y=(a instanceof Array)?a:[a];_210(this,_207.READ_WRITE,function(_){_.onerror=_209(e,x);_.oncomplete=function(){b();};for(var i=0;i<y.length;i++){var _251=_.objectStore(p);_251["delete"].call(_251,y[i]);}},e);};_211.prototype.update=function(a,b,e,p){var x=this.name;var y=this.defaultError;var _=[];var _251=[];if(a instanceof Array){_=a;_251=b;}else{_=[a];_251=[b];}_210(this,_207.READ_WRITE,function(_252){_252.onabort=_209(p,y);_252.oncomplete=function(){if(a instanceof Array){e(_,_251);}else{e(a,b);}};for(var i=0;i<_.length&&i<_251.length;i++){var _253=_252.objectStore(x).openCursor(_208.only(_[i]));_253.pair={key:_[i],value:_251[i]};_253.onsuccess=function(_254){var _255=_254.target.result;if(_255){_255.update(_254.target.pair.value);}else{_252.abort();}};}},p);};var _212=function(a){var b=[];var i=[];var e={};this.name=a;var p=function(y){return y||this.defaultError;};var x=function(y,_){var _251;if(y instanceof Array){_251="Array of keys not supported";}if(y===u||y===null){_251="Invalid key";}if(_251){A(_,{message:_251});return false;}return true;};this.add=function(y,_,_251,_252){_252=p(_252);if(x(y,_252)){if(!e.hasOwnProperty(y)){this.addOrUpdate(y,_,_251,_252);}else{_252({message:"key already exists",key:y});}}};this.addOrUpdate=function(y,_,_251,_252){_252=p(_252);if(x(y,_252)){var _253=e[y];if(_253===u){if(b.length>0){_253=b.splice(0,1);}else{_253=i.length;}}i[_253]=_;e[y]=_253;A(_251,y,_);}};this.clear=function(y){i=[];e={};b=[];A(y);};this.contains=function(y,_){var _251=e.hasOwnProperty(y);A(_,_251);};this.getAllKeys=function(y){var _=[];for(var a in e){_.push(a);}A(y,_);};this.read=function(y,_,_251){_251=p(_251);if(x(y,_251)){var _252=e[y];A(_,y,i[_252]);}};this.remove=function(y,_,_251){_251=p(_251);if(x(y,_251)){var _252=e[y];if(_252!==u){if(_252===i.length-1){i.pop();}else{i[_252]=u;b.push(_252);}delete e[y];if(i.length===0){b=[];}}A(_);}};this.update=function(y,_,_251,_252){_252=p(_252);if(x(y,_252)){if(e.hasOwnProperty(y)){this.addOrUpdate(y,_,_251,_252);}else{_252({message:"key not found",key:y});}}};};_212.create=function(a){return new _212(a);};_212.isSupported=function(){return true;};_212.prototype.close=function(){};_212.prototype.defaultError=_2;_212.prototype.mechanism="memory";var _213={indexeddb:_211,dom:_205,memory:_212};d.defaultStoreMechanism="best";d.createStore=function(a,b){if(!b){b=d.defaultStoreMechanism;}if(b==="best"){b=(_205.isSupported())?"dom":"memory";}var e=_213[b];if(e){return e.create(a);}throw{message:"Failed to create store",name:a,mechanism:b};};var _214=function(a,b,e){return function(){a[b].apply(a,arguments);return e;};};var _215=function(){this._arguments=u;this._done=u;this._fail=u;this.resolved=false;this.rejected=false;};_215.prototype={then:function(a,e){if(a){if(!this._done){this._done=[a];}else{this._done.push(a);}}if(e){if(!this._fail){this._fail=[e];}else{this._fail.push(e);}}if(this._resolved){this.resolve.apply(this,this._arguments);}else if(this._rejected){this.reject.apply(this,this._arguments);}return this;},resolve:function(){if(this._done){var i,a;for(i=0,a=this._done.length;i<a;i++){this._done[i].apply(null,arguments);}this._done=u;this._resolved=false;this._arguments=u;}else{this._resolved=true;this._arguments=arguments;}},reject:function(){if(this._fail){var i,a;for(i=0,a=this._fail.length;i<a;i++){this._fail[i].apply(null,arguments);}this._fail=u;this._rejected=false;this._arguments=u;}else{this._rejected=true;this._arguments=arguments;}},promise:function(){var a={};a.then=_214(this,"then",a);return a;}};var _216=function(){if(w.jQuery&&w.jQuery.Deferred){return new w.jQuery.Deferred();}else{return new _215();}};var _217=function(a,b){var e=(a.indexOf("?")>=0)?"&":"?";return a+e+b;};var _218=function(a,b){var i=a.indexOf("?");var e="";if(i>=0){e=a.substr(i);a=a.substr(0,i);}if(a[a.length-1]!=="/"){a+="/";}return a+b+e;};var _219=function(a,b){return{method:"GET",requestUri:a,user:b.user,password:b.password,enableJsonpCallback:b.enableJsonpCallback,callbackParameterName:b.callbackParameterName,formatQueryString:b.formatQueryString};};var _220=function(a,b){var e=-1;var i=a.indexOf("?");if(i!==-1){var p=a.indexOf("?"+b+"=",i);if(p===-1){p=a.indexOf("&"+b+"=",i);}if(p!==-1){e=p+b.length+2;}}return e;};var _221=function(a,b,e,i){var p=_222(a,b,[],e,i);return p;};var _222=function(a,b,e,i,p){var x=_219(a,b);var y=o.request(x,function(_){var _251=_.__next;var _252=_.results;e=e.concat(_252);if(_251){y=_222(_251,b,e,i,p);}else{i(e);}},p,u,b.httpClient,b.metadata);return{abort:function(){y.abort();}};};var _223=function(a){var b=this;var e=a.source;b.identifier=_10(encodeURI(decodeURI(e)));b.options=a;b.count=function(i,p){var a=b.options;return o.request(_219(_218(e,"$count"),a),function(x){var y=W(x.toString());if(isNaN(y)){p({message:"Count is NaN",count:y});}else{i(y);}},p,u,a.httpClient,a.metadata);};b.read=function(i,p,x,y){var _="$skip="+i+"&$top="+p;return _221(_217(e,_),b.options,x,y);};return b;};var _224=function(a,p){
/// <param name="operation" type="Object">Operation with (i)ndex, (c)ount and (d)ata.</param>
/// <param name="page" type="Object">Page with (i)ndex, (c)ount and (d)ata.</param>
var i=_225(a,p);if(i){var b=i.i-p.i;var e=b+(a.c-a.d.length);a.d=a.d.concat(p.d.slice(b,e));}};var _225=function(x,y){
/// <summary>Returns the {(i)ndex, (c)ount} range for the intersection of x and y.</summary>
/// <param name="x" type="Object">Range with (i)ndex and (c)ount members.</param>
/// <param name="y" type="Object">Range with (i)ndex and (c)ount members.</param>
/// <returns type="Object">The intersection (i)ndex and (c)ount; undefined if there is no intersection.</returns>
var a=x.i+x.c;var b=y.i+y.c;var e=(x.i>y.i)?x.i:y.i;var i=(a<b)?a:b;var p;if(i>=e){p={i:e,c:i-e};}return p;};var _226=function(a,b){if(a===u||typeof a!=="number"){throw{message:"'"+b+"' must be a number."};}if(isNaN(a)||a<0||!isFinite(a)){throw{message:"'"+b+"' must be greater than or equal to zero."};}};var _227=function(a,b){if(a!==u){if(typeof a!=="number"){throw{message:"'"+b+"' must be a number."};}if(isNaN(a)||a<=0||!isFinite(a)){throw{message:"'"+b+"' must be greater than zero."};}}};var _228=function(a,b){if(a!==u&&(typeof a!=="number"||isNaN(a)||!isFinite(a))){throw{message:"'"+b+"' must be a number."};}};var _229=function(a,b){var i,e;for(i=0,e=a.length;i<e;i++){if(a[i]===b){a.splice(i,1);return true;}}return false;};var _230=function(a,b){for(var e in b){a[e]=b[e];}return a;};var _231=function(a){var b=0;var e=typeof a;if(e==="object"&&a){for(var i in a){b+=i.length*2+_231(a[i]);}}else if(e==="string"){b=a.length*2;}else{b=8;}return b;};var _232=function(a,b,p){
/// <returns type="Object">A range with (i)ndex and (c)ount of elements.</returns>
a=Math.floor(a/p)*p;b=Math.ceil((b+1)/p)*p;return{i:a,c:b-a};};var _233="destroy";var _234="idle";var _235="init";var _236="read";var _237="prefetch";var _238="write";var _239="cancel";var _240="end";var _241="error";var _242="start";var _243="wait";var _244="clear";var _245="done";var _246="local";var _247="save";var _248="source";var _249=function(a,p,i,b,e,x,y){var _;var _251;var _252=this;_252.p=p;_252.i=b;_252.c=e;_252.d=x;_252.s=_242;_252.canceled=false;_252.pending=y;_252.oncomplete=null;_252.cancel=function(){if(!i){return;}var _255=_252.s;if(_255!==_241&&_255!==_240&&_255!==_239){_252.canceled=true;_254(_239,_);}};_252.complete=function(){_254(_240,_);};_252.error=function(_255){if(!_252.canceled){_254(_241,_255);}};_252.run=function(_255){_251=_255;_252.transition(_252.s,_);};_252.wait=function(x){_254(_243,x);};var _253=function(_255,_251,x){switch(_255){case _242:if(_251!==_235){a(_252,_255,_251,x);}break;case _243:a(_252,_255,_251,x);break;case _239:a(_252,_255,_251,x);_252.fireCanceled();_254(_240);break;case _241:a(_252,_255,_251,x);_252.canceled=true;_252.fireRejected(x);_254(_240);break;case _240:if(_252.oncomplete){_252.oncomplete(_252);}if(!_252.canceled){_252.fireResolved();}a(_252,_255,_251,x);break;default:a(_252,_255,_251,x);break;}};var _254=function(_255,x){_252.s=_255;_=x;_253(_255,_251,x);};_252.transition=_254;return _252;};_249.prototype.fireResolved=function(){var p=this.p;if(p){this.p=null;p.resolve(this.d);}};_249.prototype.fireRejected=function(a){var p=this.p;if(p){this.p=null;p.reject(a);}};_249.prototype.fireCanceled=function(){this.fireRejected({canceled:true,message:"Operation canceled"});};var _250=function(a){var b=_235;var e={counts:0,netReads:0,prefetches:0,cacheReads:0};var p=[];var x=[];var y=[];var _251=0;var _252=false;var _253=V(a.cacheSize,1048576);var _254=0;var _255=0;var _256=0;var _257=_253===0;var _258=V(a.pageSize,50);var _259=V(a.prefetchSize,_258);var _260="1.0";var _261;var _262=0;var _263=a.source;if(typeof _263==="string"){_263=new _223(a);}_263.options=a;var _264=d.createStore(a.name,a.mechanism);var _265=this;_265.onidle=a.idle;_265.stats=e;_265.count=function(){if(_261){throw _261;}var i=_216();var _=false;if(_252){A(function(){i.resolve(_254);});return i.promise();}var _285=_263.count(function(_286){_285=null;e.counts++;i.resolve(_286);},function(_286){_285=null;i.reject(_230(_286,{canceled:_}));});return _230(i.promise(),{cancel:function(){if(_285){_=true;_285.abort();_285=null;}}});};_265.clear=function(){if(_261){throw _261;}if(p.length===0){var i=_216();var _=new _249(_281,i,false);_274(_,p);return i.promise();}return p[0].p;};_265.filterForward=function(i,_,_285){return _271(i,_,_285,false);};_265.filterBack=function(i,_,_285){return _271(i,_,_285,true);};_265.readRange=function(i,_){_226(i,"index");_226(_,"count");if(_261){throw _261;}var _285=_216();var _286=new _249(_283,_285,true,i,_,[],0);_274(_286,x);return _230(_285.promise(),{cancel:function(){_286.cancel();}});};_265.ToObservable=_265.toObservable=function(){if(!w.Rx||!w.Rx.Observable){throw{message:"Rx library not available - include rx.js"};}if(_261){throw _261;}return w.Rx.Observable.CreateWithDisposable(function(_){var _285=false;var _286=0;var _287=function(i){if(!_285){_.OnError(i);}};var _288=function(_289){if(!_285){var i,_290;for(i=0,_290=_289.length;i<_290;i++){_.OnNext(_289[i]);}if(_289.length<_258){_.OnCompleted();}else{_286+=_258;_265.readRange(_286,_258).then(_288,_287);}}};_265.readRange(_286,_258).then(_288,_287);return{Dispose:function(){_285=true;}};});};var _266=function(_){return function(_285){_261={message:_,error:_285};var i,_286;for(i=0,_286=x.length;i<_286;i++){x[i].fireRejected(_261);}for(i=0,_286=p.length;i<_286;i++){p[i].fireRejected(_261);}x=p=null;};};var _267=function(_){if(_!==b){b=_;var _285=p.concat(x,y);var i,_286;for(i=0,_286=_285.length;i<_286;i++){_285[i].run(b);}}};var _268=function(){var i=new _215();_264.clear(function(){_251=0;_252=false;_254=0;_255=0;_256=0;_257=_253===0;e={counts:0,netReads:0,prefetches:0,cacheReads:0};_265.stats=e;_264.close();i.resolve();},function(_){i.reject(_);});return i;};var _269=function(i){var _=_229(p,i);if(!_){_=_229(x,i);if(!_){_229(y,i);}}_262--;_267(_234);};var _270=function(i){
/// <returns type="DjsDeferred">A promise for a page object with (i)ndex, (c)ount, (d)ata.</returns>
var _=new _215();var _285=false;var _286=_263.read(i,_258,function(_287){var _288={i:i,c:_287.length,d:_287};_.resolve(_288);},function(_287){_.reject(_287);});return _230(_,{cancel:function(){if(_286){_286.abort();_285=true;_286=null;}}});};var _271=function(_,_285,_286,_287){_=W(_);_285=W(_285);if(isNaN(_)){throw{message:"'index' must be a valid number.",index:_};}if(isNaN(_285)){throw{message:"'count' must be a valid number.",count:_285};}if(_261){throw _261;}_=Math.max(_,0);var _288=_216();var _289=[];var _290=false;var _291=null;var _292=function(_296,_297){if(!_290){if(_285>=0&&_289.length>=_285){_288.resolve(_289);}else{_291=_265.readRange(_296,_297).then(function(_298){for(var i=0,_299=_298.length;i<_299&&(_285<0||_289.length<_285);i++){var _300=_287?_299-i-1:i;var _301=_298[_300];if(_286(_301)){var _302={index:_296+_300,item:_301};_287?_289.unshift(_302):_289.push(_302);}}if((!_287&&_298.length<_297)||(_287&&_296<=0)){_288.resolve(_289);}else{var _303=_287?Math.max(_296-_258,0):_296+_297;_292(_303,_258);}},function(i){_288.reject(i);});}}};var _293=_232(_,_,_258);var _294=_287?_293.i:_;var _295=_287?_-_293.i+1:_293.i+_293.c-_;_292(_294,_295);return _230(_288.promise(),{cancel:function(){if(_291){_291.cancel();}_290=true;}});};var _272=function(){if(_265.onidle&&_262===0){_265.onidle();}};var _273=function(i){if(_252||_259===0||_257){return;}if(y.length===0||(y[0]&&y[0].c!==-1)){var _=new _249(_282,null,true,i,_259,null,_259);_274(_,y);}};var _274=function(i,_){i.oncomplete=_269;_.push(i);_262++;i.run(b);};var _275=function(i){
/// <returns type="DjsDeferred">A promise for a found flag and page object with (i)ndex, (c)ount, (d)ata, and (t)icks.</returns>
var _285=false;var _286=_230(new _215(),{cancel:function(){_285=true;}});var _287=_278(_286,"Read page from store failure");_264.contains(i,function(_288){if(_285){return;}if(_288){_264.read(i,function(_,_289){if(!_285){_286.resolve(_289!==u,_289);}},_287);return;}_286.resolve(false);},_287);return _286;};var _276=function(i,_){
/// <param name="page" type="Object">Object with (i)ndex, (c)ount, (d)ata, and (t)icks.</param>
var _285=false;var _286=_230(new _215(),{cancel:function(){_285=true;}});var _287=_278(_286,"Save page to store failure");var _288=function(){_286.resolve(true);};if(_.c>0){var _289=_231(_);_257=_253>=0&&_253<_251+_289;if(!_257){_264.addOrUpdate(i,_,function(){_279(_,_289);_277(_288,_287);},_287);}else{_288();}}else{_279(_,0);_277(_288,_287);}return _286;};var _277=function(i,_){var _285={actualCacheSize:_251,allDataLocal:_252,cacheSize:_253,collectionCount:_254,highestSavedPage:_255,highestSavedPageSize:_256,pageSize:_258,sourceId:_263.identifier,version:_260};_264.addOrUpdate("__settings",_285,i,_);};var _278=function(i){return function(){i.resolve(false);};};var _279=function(i,_){
/// <param name="page" type="Object">Object with (i)ndex, (c)ount, (d)ata.</param>
var _285=i.c;var _286=i.i;if(_285===0){if(_255===_286-_258){_254=_255+_256;}}else{_255=Math.max(_255,_286);if(_255===_286){_256=_285;}_251+=_;if(_285<_258&&!_254){_254=_286+_285;}}if(!_252&&_254===_255+_256){_252=true;}};var _280=function(i,_,_285,_286){var _287=i.canceled&&_!==_240;if(_287){if(_===_239){if(_286&&_286.cancel){_286.cancel();}}}return _287;};var _281=function(i,_,_285){var _286=i.transition;if(_285!==_233){_267(_233);return true;}switch(_){case _242:_286(_244);break;case _240:_272();break;case _244:_268().then(function(){i.complete();});i.wait();break;default:return false;}return true;};var _282=function(i,_,_285,_286){if(!_280(i,_,_285,_286)){var _287=i.transition;if(_285!==_237){if(_285===_233){if(_!==_239){i.cancel();}}else if(_285===_234){_267(_237);}return true;}switch(_){case _242:if(y[0]===i){_287(_246,i.i);}break;case _245:var _288=i.pending;if(_288>0){_288-=Math.min(_288,_286.c);}if(_252||_288===0||_286.c<_258||_257){i.complete();}else{i.pending=_288;_287(_246,_286.i+_258);}break;default:return _284(i,_,_285,_286,true);}}return true;};var _283=function(i,_,_285,_286){if(!_280(i,_,_285,_286)){var _287=i.transition;if(_285!==_236&&_!==_242){if(_285===_233){if(_!==_242){i.cancel();}}else if(_285!==_238){_267(_236);}return true;}switch(_){case _242:if(_285===_234||_285===_237){_267(_236);if(i.c>0){var _288=_232(i.i,i.c,_258);_287(_246,_288.i);}else{_287(_245,i);}}break;case _245:_224(i,_286);var _289=i.d.length;if(i.c===_289||_286.c<_258){e.cacheReads++;_273(_286.i+_286.c);i.complete();}else{_287(_246,_286.i+_258);}break;default:return _284(i,_,_285,_286,false);}}return true;};var _284=function(i,_,_285,_286,_287){var _288=i.error;var _289=i.transition;var _290=i.wait;var _291;switch(_){case _240:_272();break;case _246:_291=_275(_286).then(function(_292,_293){if(!i.canceled){if(_292){_289(_245,_293);}else{_289(_248,_286);}}});break;case _248:_291=_270(_286).then(function(_292){if(!i.canceled){if(_287){e.prefetches++;}else{e.netReads++;}_289(_247,_292);}},_288);break;case _247:if(_285!==_238){_267(_238);_291=_276(_286.i,_286).then(function(_292){if(!i.canceled){if(!_292&&_287){i.pending=0;}_289(_245,_286);}_267(_234);});}break;default:return false;}if(_291){if(i.canceled){_291.cancel();}else if(i.s===_){_290(_291);}}return true;};_264.read("__settings",function(_,i){if(t(i)){var _285=i.version;if(!_285||_285.indexOf("1.")!==0){_266("Unsupported cache store version "+_285)();return;}if(_258!==i.pageSize||_263.identifier!==i.sourceId){_268().then(function(){_267(_234);},_266("Unable to clear store during initialization"));}else{_251=i.actualCacheSize;_252=i.allDataLocal;_253=i.cacheSize;_254=i.collectionCount;_255=i.highestSavedPage;_256=i.highestSavedPageSize;_260=_285;_267(_234);}}else{_277(function(){_267(_234);},_266("Unable to write settings during initialization."));}},_266("Unable to read settings from store."));return _265;};d.createDataCache=function(a){_227(a.pageSize,"pageSize");_228(a.cacheSize,"cacheSize");_228(a.prefetchSize,"prefetchSize");if(!t(a.name)){throw{message:"Undefined or null name",options:a};}if(!t(a.source)){throw{message:"Undefined source",options:a};}return new _250(a);};})(window);
