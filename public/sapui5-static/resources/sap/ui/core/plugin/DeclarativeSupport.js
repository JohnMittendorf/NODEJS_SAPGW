/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 * 
 * (c) Copyright 2009-2012 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.ui.core.plugin.DeclarativeSupport");jQuery.sap.require("sap.ui.core.Core");
sap.ui.core.plugin.DeclarativeSupport=function(){};
sap.ui.core.plugin.DeclarativeSupport.prototype.startPlugin=function(c,o){jQuery.sap.log.info("Starting DeclarativeSupport plugin.");jQuery.sap.log.warning("DeclarativeSupport is an experimental feature which might change in future!");this.oCore=c;this.oWindow=window;this._parse();};
sap.ui.core.plugin.DeclarativeSupport.prototype.stopPlugin=function(){jQuery.sap.log.info("Stopping DeclarativeSupport plugin.");this.oCore=null;};
sap.ui.core.plugin.DeclarativeSupport.prototype._parse=function(r){r=r||document.body;var d=jQuery("[data-sap-ui-type]",r);var a=[];jQuery.each(d,function(k,o){if(jQuery(o).parents("[data-sap-ui-type]").length===0){a.push(o);}});var t=this;jQuery.each(a,function(k,o){t._parseRootDomRef(o);});};
sap.ui.core.plugin.DeclarativeSupport.prototype._parseRootDomRef=function(d){var j=jQuery(d);var t=j.attr("data-sap-ui-type");var c=[];if(t==="sap.ui.core.UIArea"){var a=this;jQuery.each(j.children(),function(k,d){var o=a._parseDomRef(d);if(o){c.push(o);}});}else if(t){var o=this._parseDomRef(d);if(o){c.push(o);}}j.empty();jQuery.each(c,function(k,o){o.placeAt(d);});j.removeAttr("data-sap-ui-type");};
sap.ui.core.plugin.DeclarativeSupport.prototype._parseDomRef=function(d){var j=jQuery(d);var c=j.attr("data-sap-ui-type");if(c){var s="";if(j.attr("id")){s=j.attr("id");j.attr("id","");}var o=new(jQuery.sap.getObject(c))(s);var a={};for(var k in d.attributes){if(!isNaN(k)){var n=d.attributes[k].name;if(n!="data-sap-ui-type"&&n!="data-sap-ui-aggregation"&&n!="data-sap-ui-default-aggregation"&&n!="id"&&n!="tooltip"){n=this._camelCase(n);var v=d.attributes[k].value;if(o.getMetadata().getAllProperties()[n]){var p=o.getMetadata().getAllProperties()[n];var t=sap.ui.base.DataType.getType(p.type);if(t){if(t instanceof sap.ui.base.DataType){a[n]=t.parseValue(v);}else{a[n]=v;}}}else if(o.getMetadata().getAllAssociations()[n]){a[n]=v;}else if(o.getMetadata().getAllEvents()[n]){var w=window;if(v&&v.indexOf(".")!=-1){var b=v.split(".");for(var i=0;i<b.length-1;i++){w=w[b[i]];if(!w){v=null;break;}}v=b[b.length-1];}if(v&&typeof(w[v])=="function"){a[n]=w[v];}}}else if(n=="tooltip"){a[n]=d.attributes[k].value;}}}var e=j.children();var f=j.attr("data-sap-ui-default-aggregation")||o.getMetadata().getDefaultAggregationName();var g=o.getMetadata().getAllAggregations();if(!f&&g){for(var h in g){if(h!=="tooltip"){f=h;break;}}}var l=this;jQuery.each(j.children(),function(k,q){var r=jQuery(q).attr("data-sap-ui-aggregation");var u=false;if(!r){u=true;r=f;}if(r&&g[r]){var x=g[r].multiple;jQuery.each(u?[this]:jQuery(q).children(),function(k,y){var o=l._parseDomRef(y);if(o){if(x){if(!a[r]){a[r]=[];}a[r].push(o);}else{a[r]=o;}}});}});o.applySettings(a);j.removeAttr("data-sap-ui-type");return o;}else{var m=new sap.ui.core.HTML({preferDOM:true});m.setDOMContent(d);this._parse(d);return m;}return null;};
sap.ui.core.plugin.DeclarativeSupport.prototype._camelCase=function(s){if(s.indexOf("-")!=-1){var a=s.split("-");var b=[];for(var i=0;i<a.length;i++){if(i>0&&a[i].length>1){b.push(a[i].substring(0,1).toUpperCase());b.push(a[i].substring(1));}else{b.push(a[i]);}}s=b.join("");}return s;};
(function(){var t=new sap.ui.core.plugin.DeclarativeSupport();sap.ui.getCore().registerPlugin(t);}());
