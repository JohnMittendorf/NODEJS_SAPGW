/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 * 
 * (c) Copyright 2009-2012 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.ui.ux3.ExactBrowser");jQuery.sap.require("sap.ui.ux3.library");jQuery.sap.require("sap.ui.core.Control");sap.ui.core.Control.extend("sap.ui.ux3.ExactBrowser",{metadata:{publicMethods:["reset"],library:"sap.ui.ux3",properties:{"title":{type:"string",group:"Misc",defaultValue:null},"headerTitle":{type:"string",group:"Misc",defaultValue:null},"visible":{type:"boolean",group:"",defaultValue:true},"enableListClose":{type:"boolean",group:"Misc",defaultValue:false},"listHeight":{type:"int",group:"Appearance",defaultValue:290},"showHeader":{type:"boolean",group:"Misc",defaultValue:false},"enableReset":{type:"boolean",group:"Misc",defaultValue:true}},defaultAggregation:"attributes",aggregations:{"attributes":{type:"sap.ui.ux3.ExactAttribute",multiple:true,singularName:"attribute"},"optionsMenu":{type:"sap.ui.commons.Menu",multiple:false}},associations:{"followUpControl":{type:"sap.ui.core.Control",multiple:false}},events:{"attributeSelected":{}}}});sap.ui.ux3.ExactBrowser.M_EVENTS={'attributeSelected':'attributeSelected'};jQuery.sap.require("sap.ui.ux3.ExactAttribute");jQuery.sap.require("sap.ui.ux3.ExactList");jQuery.sap.require("sap.ui.commons.Menu");jQuery.sap.require("sap.ui.commons.Button");(function(){sap.ui.ux3.ExactBrowser.getMetadata()._mHiddenAggregations={"controls":{multiple:true,type:"sap.ui.core.Control"}};sap.ui.ux3.ExactBrowser.prototype.init=function(){var t=this;this._rb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.ux3");this._attributeRoot=new sap.ui.ux3.ExactAttribute();this._attributeRoot.setParent(this);this._rootList=new sap.ui.ux3.ExactList(this.getId()+"-rootlist");this._rootList.setData(this._attributeRoot);this.addAggregation("controls",this._rootList);this._resetButton=new sap.ui.commons.Button(this.getId()+"-RstBtn",{text:this._rb.getText("EXACT_BRWSR_RESET"),lite:true});this._resetButton.addStyleClass("sapUiUx3ExactBrwsrReset");this.addAggregation("controls",this._resetButton);this._resetButton.attachPress(function(){t.reset();});this._saveButton=new sap.ui.commons.Button(this.getId()+"-SvBtn",{text:this._rb.getText("EXACT_BRWSR_SAVE"),lite:true});this._saveButton.addStyleClass("sapUiUx3ExactBrwsrSave");this.addAggregation("controls",this._saveButton);this._saveButton.attachPress(function(){o(t);});this._rootList.attachAttributeSelected(function(e){t.fireAttributeSelected({attribute:e.getParameter("attribute"),allAttributes:e.getParameter("allAttributes")});});this._rootList.attachWidthChanged(function(e){var m=t._getMenuButton(false);if(m){m.setProperty("width",e.getParameter("width"),true);jQuery(m.getDomRef()).css("width",e.getParameter("width"));}});};sap.ui.ux3.ExactBrowser.prototype.exit=function(){this._rootList.destroy();var m=this._getMenuButton(false);if(m){m.destroy();this._menuButton=null;}this._attributeRoot.destroy();this._rootList=null;this._attributeRoot=null;this._resetButton=null;this._saveButton=null;this._saveDialog=null;this._saveTextField=null;this._rb=null;};sap.ui.ux3.ExactBrowser.prototype.onkeydown=function(e){if(e.keyCode!=jQuery.sap.KeyCodes.F6||!this.getFollowUpControl()){return;}var f=sap.ui.getCore().byId(this.getFollowUpControl());if(f){e.preventDefault();f.focus();}};sap.ui.ux3.ExactBrowser.prototype.onThemeChanged=function(e){this.invalidate();};sap.ui.ux3.ExactBrowser.prototype.getEnableSave=function(){return!!this.__enableSave;};sap.ui.ux3.ExactBrowser.prototype.getTitle=function(){return this._rootList.getTopTitle();};sap.ui.ux3.ExactBrowser.prototype.setTitle=function(t){this._rootList.setTopTitle(t);var m=this._getMenuButton(false);if(m){m.setText(this._rootList.getTopTitle());}return this;};sap.ui.ux3.ExactBrowser.prototype.getHeaderTitle=function(){var t=this.getProperty("headerTitle");return t?t:this._rb.getText("EXACT_BRWSR_TITLE");};sap.ui.ux3.ExactBrowser.prototype.getEnableListClose=function(){return this._rootList.getShowClose();};sap.ui.ux3.ExactBrowser.prototype.setEnableListClose=function(e){this._rootList.setShowClose(e);return this;};sap.ui.ux3.ExactBrowser.prototype.getListHeight=function(){return this._rootList.getTopHeight();};sap.ui.ux3.ExactBrowser.prototype.setListHeight=function(l){this._rootList.setTopHeight(l);return this;};sap.ui.ux3.ExactBrowser.prototype.getOptionsMenu=function(){var m=this._getMenuButton(false);return m?m.getMenu():null;};sap.ui.ux3.ExactBrowser.prototype.setOptionsMenu=function(a){var m=this._getMenuButton(true);m.setMenu(a);return this;};sap.ui.ux3.ExactBrowser.prototype.destroyOptionsMenu=function(){var m=this._getMenuButton(false);if(m){m.destroyMenu();}return this;};sap.ui.ux3.ExactBrowser.prototype.getAttributes=function(){return this._attributeRoot.getAttributesInternal();};sap.ui.ux3.ExactBrowser.prototype.insertAttribute=function(a,i){this._attributeRoot.insertAttribute(a,i);return this;};sap.ui.ux3.ExactBrowser.prototype.addAttribute=function(a){this._attributeRoot.addAttribute(a);return this;};sap.ui.ux3.ExactBrowser.prototype.removeAttribute=function(e){return this._attributeRoot.removeAttribute(e);};sap.ui.ux3.ExactBrowser.prototype.removeAllAttributes=function(){return this._attributeRoot.removeAllAttributes();};sap.ui.ux3.ExactBrowser.prototype.indexOfAttribute=function(a){return this._attributeRoot.indexOfAttribute(a);};sap.ui.ux3.ExactBrowser.prototype.destroyAttributes=function(){this._attributeRoot.destroyAttributes();return this;};sap.ui.ux3.ExactBrowser.prototype.reset=function(){this._rootList._closeAll();};sap.ui.ux3.ExactBrowser.prototype._getMenuButton=function(f){if(this._menuButton){return this._menuButton;}if(f){jQuery.sap.require("sap.ui.commons.MenuButton");this._menuButton=new sap.ui.commons.MenuButton(this.getId()+"-MnuBtn",{text:this.getTitle(),lite:true});this._menuButton.addStyleClass("sapUiUx3ExactBrwsrBtn");this.addAggregation("controls",this._menuButton);var t=this;this._menuButton.addDelegate({onAfterRendering:function(){var z=t._menuButton.__zIndex?t._menuButton.__zIndex:sap.ui.core.Popup.getNextZIndex();t._menuButton.__zIndex=z;jQuery(t._menuButton.getDomRef()).css("z-index",z);}});return this._menuButton;}return null;};function d(e,s){e._saveDialog.close();if(!s){alert("Save: "+e._saveTextField.getValue());}}function o(e){if(!e._saveDialog){jQuery.sap.require("sap.ui.ux3.ToolPopup");jQuery.sap.require("sap.ui.commons.Textfield");jQuery.sap.require("sap.ui.commons.Label");e._saveTextField=new sap.ui.commons.TextField(e.getId()+"-SvDlgTf");var l=new sap.ui.commons.Label({text:e._rb.getText("EXACT_BRWSR_DLG_LABEL")}).setLabelFor(e._saveTextField);e._saveDialog=new sap.ui.ux3.ToolPopup(e.getId()+"-SvDlg",{content:[l,e._saveTextField],buttons:[new sap.ui.commons.Button(e.getId()+"-SvDlgSvBtn",{text:e._rb.getText("EXACT_BRWSR_DLG_SAVE"),press:function(){d(e);}}),new sap.ui.commons.Button(e.getId()+"-SvDlgCnclBtn",{text:e._rb.getText("EXACT_BRWSR_DLG_CANCEL"),press:function(){d(e,true);}})]});e._saveDialog.addStyleClass("sapUiUx3ExactBrwsrSaveDlg");e.addAggregation("controls",e._saveDialog);}e._saveDialog.setPosition(sap.ui.core.Popup.Dock.EndTop,sap.ui.core.Popup.Dock.EndBottom,e._saveButton.getDomRef(),"0 13","none");e._saveDialog.open();}}());
