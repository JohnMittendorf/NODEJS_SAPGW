/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 * 
 * (c) Copyright 2009-2012 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.ui.ux3.Shell");jQuery.sap.require("sap.ui.ux3.library");jQuery.sap.require("sap.ui.core.Control");sap.ui.core.Control.extend("sap.ui.ux3.Shell",{metadata:{publicMethods:["setContent","setPaneContent","openPersonalizationDialog","initializePersonalization","getSearchField","openPane","closePane","isPaneOpen"],library:"sap.ui.ux3",properties:{"appTitle":{type:"string",group:"Misc",defaultValue:null},"appIcon":{type:"sap.ui.core.URI",group:"Misc",defaultValue:null},"appIconTooltip":{type:"string",group:"Misc",defaultValue:null},"showLogoutButton":{type:"boolean",group:"Misc",defaultValue:true},"showSearchTool":{type:"boolean",group:"Misc",defaultValue:true},"showInspectorTool":{type:"boolean",group:"Misc",defaultValue:true},"showFeederTool":{type:"boolean",group:"Misc",defaultValue:true},"paneWidth":{type:"int",group:"Misc",defaultValue:250}},defaultAggregation:"content",aggregations:{"worksetItems":{type:"sap.ui.ux3.NavigationItem",multiple:true,singularName:"worksetItem"},"paneBarItems":{type:"sap.ui.core.Item",multiple:true,singularName:"paneBarItem"},"paneContent":{type:"sap.ui.core.Control",multiple:true,singularName:"paneContent"},"content":{type:"sap.ui.core.Control",multiple:true,singularName:"content"},"toolPopups":{type:"sap.ui.ux3.ToolPopup",multiple:true,singularName:"toolPopup"},"headerItems":{type:"sap.ui.core.Control",multiple:true,singularName:"headerItem"}},associations:{"selectedWorksetItem":{type:"sap.ui.ux3.NavigationItem",multiple:false}},events:{"worksetItemSelected":{allowPreventDefault:true},"paneBarItemSelected":{},"logout":{},"search":{},"feedSubmit":{}}}});sap.ui.ux3.Shell.M_EVENTS={'worksetItemSelected':'worksetItemSelected','paneBarItemSelected':'paneBarItemSelected','logout':'logout','search':'search','feedSubmit':'feedSubmit'};sap.ui.ux3.Shell.WSI_MENU_DELAY=200;sap.ui.ux3.Shell.WSI_OVERFLOW_SCROLL_STEP=250;sap.ui.ux3.Shell.TOOL_PREFIX="-tool-";sap.ui.ux3.Shell.FIRST_RENDERING=true;
sap.ui.ux3.Shell.prototype.init=function(){this._iOpenPaneIndex=-1;this._sOpenWsiId=null;this._bPreviousScrollRight=false;this._bPreviousScrollLeft=false;this._sSelectedWorksetId=null;this._sSelectedFacetId=null;this._oWorksetBar=new sap.ui.ux3.NavigationBar(this.getId()+"-wsBar",{toplevelVariant:true,select:[this._handleWorksetBarSelect,this]}).setParent(this);this._oFacetBar=new sap.ui.ux3.NavigationBar(this.getId()+"-facetBar",{select:[this._handleFacetBarSelect,this]}).setParent(this);};
sap.ui.ux3.Shell.prototype.exit=function(){if(this._oWorksetBar){this._oWorksetBar.destroy();}if(this._oFacetBar){this._oFacetBar.destroy();}this._oSearchField=null;};
sap.ui.ux3.Shell.prototype.onBeforeRendering=function(){var i=this.getId();this._beforeRenderingToolPalette();if(window.FileReader){var $=jQuery.sap.byId(i+"-hdr");$.unbind('dragover',this._handleDragover).unbind('dragend',this._handleDragend).unbind('drop',this._handleDrop);var a=jQuery.sap.byId(i+"-bgImg");a.unbind('dragover',jQuery.proxy(this._handleDragover)).unbind('dragend',this._handleDragend).unbind('drop',this._handleDrop);}};
sap.ui.ux3.Shell.prototype.onAfterRendering=function(){var i=this.getId();this._afterRenderingToolPalette();if(window.FileReader){var $=jQuery.sap.byId(i+"-hdr");$.bind('dragover',jQuery.proxy(this._handleDragover,this)).bind('dragend',jQuery.proxy(this._handleDragend,this)).bind('drop',jQuery.proxy(this._handleDrop,this));var a=jQuery.sap.byId(i+"-bgImg");a.bind('dragover',jQuery.proxy(this._handleDragover,this)).bind('dragend',jQuery.proxy(this._handleDragend,this)).bind('drop',jQuery.proxy(this._handleDrop,this));}var s=(this._oFacetBar.getAssociatedItems().length>0);jQuery.sap.byId(this.getId()+"-facetBar").css("display",(s?"block":"none"));this._bRtl=sap.ui.getCore().getConfiguration().getRTL();if(this._getPersonalization().hasChanges()){this._getPersonalization().applySettings(this._getPersonalization().oSettings);}if(!this._oPaneItemNavigation){this._oPaneItemNavigation=new sap.ui.core.delegate.ItemNavigation().setCycling(false);this.addDelegate(this._oPaneItemNavigation);}var p=jQuery.sap.byId(this.getId()+"-paneBar").find(".sapUiUx3ShellPaneEntries");this._updatePaneBarItemNavigation(p);sap.ui.ux3.Shell.FIRST_RENDERING=false;};
sap.ui.ux3.Shell.prototype._updatePaneBarItemNavigation=function(p){this._oPaneItemNavigation.setRootDomRef(p[0]);var a=p.children().toArray();this._oPaneItemNavigation.setItemDomRefs(a);if(this._oPaneItemNavigation.getFocusedIndex()>a.length){this._oPaneItemNavigation.setFocusedIndex(-1);}};
sap.ui.ux3.Shell.prototype.getFocusInfo=function(){try{var e=document.activeElement;return e?{'sFocusId':e.id,'oFocusedElement':e}:{};}catch(a){return{};}};
sap.ui.ux3.Shell.prototype.applyFocusInfo=function(f){var e=jQuery.sap.domById(f.sFocusId)||f.oFocusedElement;jQuery.sap.focus(e);};
sap.ui.ux3.Shell._updateToolIcon=function(d){if(d&&d.firstChild){var $=jQuery(d);var t=d.id.substr(d.id.indexOf(sap.ui.ux3.Shell.TOOL_PREFIX)+6);var a=sap.ui.getCore().byId(t);var i=$.is(".sapUiUx3ShellToolSelected")?a.getIconSelected():($.is(".sapUiUx3ShellToolHover")?a.getIconHover():a.getIcon());d.firstChild.src=i;}};
sap.ui.ux3.Shell.prototype.onclick=function(e){this.onUserActivation(e);};
sap.ui.ux3.Shell.prototype.onsapspace=function(e){this.onUserActivation(e);};
sap.ui.ux3.Shell.prototype.onsapenter=function(e){this.onUserActivation(e);};
sap.ui.ux3.Shell.prototype.onUserActivation=function(e){var t=e.target.id;var i=this.getId().length;var p=e.target.parentNode;if(e.target.className&&e.target.className.indexOf("sapUiUx3ShellHeader-logout")>-1){this.fireLogout();}else if(p&&p.parentNode&&p.parentNode.className&&p.parentNode.className.indexOf("sapUiUx3ShellToolPaletteArea")>-1){this._handleToolItemClick(t);}else if(p&&p.parentNode&&p.parentNode.parentNode&&p.parentNode.parentNode.className&&p.parentNode.parentNode.className.indexOf("sapUiUx3ShellToolPaletteArea")>-1){this._handleToolItemClick(p.id);}else if(t){if(jQuery.sap.startsWith(t,this.getId()+"-pb_")){var a=t.substr(i+4);this._handlePaneBarItemClick(a);}}};
sap.ui.ux3.Shell.prototype._handleWorksetBarSelect=function(e){var p=this._handleWorksetItemClick(e.getParameter("item"));if(!p){e.preventDefault();}};
sap.ui.ux3.Shell.prototype._handleFacetBarSelect=function(e){var p=this._handleWorksetItemClick(e.getParameter("item"));if(!p){e.preventDefault();}};
sap.ui.ux3.Shell.prototype._handleWorksetItemClick=function(e){var p=e.getParent(),i=e.getId(),f=i,b=true;if(p instanceof sap.ui.ux3.Shell){if(i!=this._sSelectedWorksetId){var s=e.getSubItems();if(s.length>0){f=s[0].getId();}b=this._fireWorksetItemSelected(f);if(b){this._sSelectedWorksetId=i;if(s.length>0){this._sSelectedFacetId=s[0].getId();i=this._sSelectedFacetId;}else{this._sSelectedFacetId=null;}var s=e.getSubItems();this._oFacetBar.setAssociatedItems(s,true);if(s.length>0){if(!this._oFacetBar.isSelectedItemValid()){this._oFacetBar.setSelectedItem(s[0]);this._sSelectedFacetId=s[0].getId();}jQuery.sap.byId(this.getId()+"-facetBar").slideDown();}else{this._oFacetBar.setSelectedItem(null);jQuery.sap.byId(this.getId()+"-facetBar").slideUp();}}}}else{if(i!=this._sSelectedFacetId){b=this._fireWorksetItemSelected(f);if(b){this._sSelectedFacetId=i;}}}return b;};
sap.ui.ux3.Shell.prototype._fireWorksetItemSelected=function(i){var a=sap.ui.getCore().byId(i);var k=(a?a.getKey():null);var p=this.fireWorksetItemSelected({id:i,item:a,key:k});if(p){this.setAssociation("selectedWorksetItem",i,true);}return p;};
sap.ui.ux3.Shell.prototype._handleToolItemClick=function(i){var a=undefined;if(this._oOpenToolPopup){a=this._oOpenToolPopup.getId();jQuery.sap.byId(this.getId()+sap.ui.ux3.Shell.TOOL_PREFIX+this._oOpenToolPopup.getId()).removeClass("sapUiUx3ShellToolSelected").attr("aria-pressed","false");if(this._oOpenToolPopup.getId()===this.getId()+"-feederTool"){var f=sap.ui.getCore().byId(this.getId()+"-feeder");f.setText("");f.rerender();}this._oOpenToolPopup.close();this._oOpenToolPopup=null;}var t;var b=i.substr(i.indexOf(sap.ui.ux3.Shell.TOOL_PREFIX)+6);if(b==(this.getId()+"-searchTool")){t=this._getSearchTool();}else if(b==(this.getId()+"-inspectorTool")){t=this._getInspectorTool();}else if(b==(this.getId()+"-feederTool")){t=this._getFeederTool();}else{t=sap.ui.getCore().byId(b);}if(t&&(t.getId()!=a)){this._oOpenToolPopup=t;t.setPosition(sap.ui.core.Popup.Dock.BeginTop,sap.ui.core.Popup.Dock.EndTop,jQuery.sap.domById(i),"13 -6","none");t.open();jQuery.sap.byId(i).addClass("sapUiUx3ShellToolSelected").attr("aria-pressed","true");sap.ui.ux3.Shell._updateToolIcon(jQuery.sap.domById(i));var c=this;t.attachEvent("close_always",function(e){jQuery.sap.byId(i).removeClass("sapUiUx3ShellToolSelected");c._oOpenToolPopup=null;sap.ui.ux3.Shell._updateToolIcon(jQuery.sap.domById(i));});}else if(t.getId()==a){sap.ui.ux3.Shell._updateToolIcon(jQuery.sap.domById(i));}};
sap.ui.ux3.Shell.prototype._getSearchTool=function(){if(!this._oSearchPopup){var r=sap.ui.getCore().getLibraryResourceBundle("sap.ui.ux3");this._oSearchPopup=new sap.ui.ux3.ToolPopup(this.getId()+"-searchTool",{tooltip:r.getText("SHELL_SEARCH")}).addStyleClass("sapUiUx3TP-search");var t=this;var s=new sap.ui.commons.SearchField(this.getId()+"-searchField",{enableListSuggest:false,search:function(e){t.fireSearch({text:e.getParameter("query")});}});var l=new sap.ui.commons.Label({text:"Search:"}).setLabelFor(s);this._oSearchPopup.addContent(l).addContent(s);this._oSearchPopup.attachOpen(function(){window.setTimeout(function(){s.focus();},100);});this._oSearchField=s;}return this._oSearchPopup;};
sap.ui.ux3.Shell.prototype.getSearchField=function(){if(!this._oSearchField){this._getSearchTool();}return this._oSearchField;};
sap.ui.ux3.Shell.prototype._getInspectorTool=function(){if(!this._oInspectorPopup){var r=sap.ui.getCore().getLibraryResourceBundle("sap.ui.ux3");this._oInspectorPopup=new sap.ui.ux3.ToolPopup(this.getId()+"-inspectorTool",{tooltip:r.getText("SHELL_TI")}).addStyleClass("sapUiUx3TP-inspector");var l=new sap.ui.commons.Label({text:"[Once finished, the ThingInspector will open here.]"});this._oInspectorPopup.addContent(l);}return this._oInspectorPopup;};
sap.ui.ux3.Shell.prototype._getFeederTool=function(){if(!this._oFeederPopup){var t=this;var r=sap.ui.getCore().getLibraryResourceBundle("sap.ui.ux3");this._oFeederPopup=new sap.ui.ux3.ToolPopup(this.getId()+"-feederTool",{tooltip:r.getText("SHELL_FEEDER")}).addStyleClass("sapUiUx3TP-feeder");var f=new sap.ui.ux3.Feeder(this.getId()+"-feeder",{type:sap.ui.ux3.FeederType.Medium,submit:function(e){t.fireFeedSubmit({text:e.getParameter("text")});f.setText("");f.rerender();t._oFeederPopup.close();}});this._oFeederPopup.setInitialFocus(this.getId()+"-feeder");this._oFeederPopup.attachClose(function(){f.setText("");});this._oFeederPopup.addContent(f);}return this._oFeederPopup;};
sap.ui.ux3.Shell.prototype.openPane=function(p){var i=sap.ui.getCore().byId(p);if(i&&(p!=this._sOpenPaneId)){var k=(i?(i.getKey()==""?null:i.getKey()):null);this.firePaneBarItemSelected({"id":p,"item":i,"key":k});jQuery.sap.byId(this.getId()+"-pb_"+p).addClass("sapUiUx3ShellPaneEntrySelected");if(!this._sOpenPaneId){this._openPane();}else{jQuery.sap.byId(this.getId()+"-pb_"+this._sOpenPaneId).removeClass("sapUiUx3ShellPaneEntrySelected");}this._sOpenPaneId=p;}return this;};
sap.ui.ux3.Shell.prototype.closePane=function(){if(this._sOpenPaneId){this._closePane();jQuery.sap.byId(this.getId()+"-pb_"+this._sOpenPaneId).removeClass("sapUiUx3ShellPaneEntrySelected");this._sOpenPaneId=null;}return this;};
sap.ui.ux3.Shell.prototype.isPaneOpen=function(){return(this._sOpenPaneId!=null);};
sap.ui.ux3.Shell.prototype._handlePaneBarItemClick=function(p){if(p===this._sOpenPaneId){this.closePane();}else{this.openPane(p);}};
(function(){sap.ui.ux3.Shell._PANE_OUTER_DISTANCE=42;var P=sap.ui.ux3.Shell._PANE_OUTER_DISTANCE;sap.ui.ux3.Shell.prototype._closePane=function(){var i=this.getId();if(this._bRtl){jQuery.sap.byId(i+"-canvas").stop().animate({left:P+"px"});jQuery(this._aSizeSyncRef).stop().animate({left:P+"px"});jQuery.sap.byId(i+"-wBar").stop().animate({marginLeft:(P+14)+"px"});jQuery.sap.byId(i+"-canvasBackground").removeClass("sapUiUx3ShellCanvasBackgroundOpen").addClass("sapUiUx3ShellCanvasBackgroundClosed");jQuery.sap.byId(i+"-canvasBackground").stop().animate({left:P+"px"},function(){jQuery.sap.byId(i+"-paneBar").removeClass("sapUiUx3ShellPaneBarOpen");});}else{jQuery.sap.byId(i+"-canvas").stop().animate({right:P+"px"});jQuery(this._aSizeSyncRef).stop().animate({right:P+"px"});jQuery.sap.byId(i+"-wBar").stop().animate({marginRight:(P+14)+"px"});jQuery.sap.byId(i+"-canvasBackground").removeClass("sapUiUx3ShellCanvasBackgroundOpen").addClass("sapUiUx3ShellCanvasBackgroundClosed");jQuery.sap.byId(i+"-canvasBackground").stop().animate({right:P+"px"},function(){jQuery.sap.byId(i+"-paneBar").removeClass("sapUiUx3ShellPaneBarOpen");});}};sap.ui.ux3.Shell.prototype._openPane=function(){var a=this.getPaneWidth();var i=this.getId();if(this._bRtl){jQuery.sap.byId(i+"-paneBar").addClass("sapUiUx3ShellPaneBarOpen");jQuery.sap.byId(i+"-wBar").stop().animate({marginLeft:(a+P+22)+"px"});jQuery.sap.byId(i+"-canvas").stop().animate({left:(a+P)+"px"});jQuery(this._aSizeSyncRef).stop().animate({left:(a+P)+"px"});jQuery.sap.byId(i+"-canvasBackground").stop().animate({left:(a+P)+"px"},function(){jQuery.sap.byId(i+"-canvasBackground").removeClass("sapUiUx3ShellCanvasBackgroundClosed").addClass("sapUiUx3ShellCanvasBackgroundOpen");});}else{jQuery.sap.byId(i+"-paneBar").addClass("sapUiUx3ShellPaneBarOpen");jQuery.sap.byId(i+"-wBar").stop().animate({marginRight:(a+P+22)+"px"});jQuery.sap.byId(i+"-canvas").stop().animate({right:(a+P)+"px"});jQuery(this._aSizeSyncRef).stop().animate({right:(a+P)+"px"});jQuery.sap.byId(i+"-canvasBackground").stop().animate({right:(a+P)+"px"},function(){jQuery.sap.byId(i+"-canvasBackground").removeClass("sapUiUx3ShellCanvasBackgroundClosed").addClass("sapUiUx3ShellCanvasBackgroundOpen");});}};sap.ui.ux3.Shell.prototype.setPaneWidth=function(w){if(typeof w=="number"&&(w>0)){w=Math.max(w,50);if(this.getDomRef()){var i=this.getId();jQuery.sap.byId(i+"-paneContent").css("width",w+"px");if(!!this._sOpenPaneId){if(this._bRtl){jQuery.sap.byId(i+"-wBar").css("marginLeft",(w+P+22)+"px");jQuery.sap.byId(i+"-canvas").css("left",(w+P)+"px");jQuery(this._aSizeSyncRef).css("left",(w+P)+"px");jQuery.sap.byId(i+"-canvasBackground").css("left",(w+P)+"px");}else{jQuery.sap.byId(i+"-wBar").css("marginRight",(w+P+22)+"px");jQuery.sap.byId(i+"-canvas").css("right",(w+P)+"px");jQuery(this._aSizeSyncRef).css("right",(w+P)+"px");jQuery.sap.byId(i+"-canvasBackground").css("right",(w+P)+"px");}}}this.setProperty("paneWidth",w,true);}return this;};}());
sap.ui.ux3.Shell.prototype.syncWithCanvasSize=function(d){this._aSizeSyncRef=d;if(d){var c=jQuery.sap.domById(this.getId()+"-canvas");d.style.left=c.offsetLeft+"px";d.style.right=(jQuery(document).width()-c.offsetLeft-c.offsetWidth)+"px";d.style.top=jQuery.sap.domById(this.getId()+"-hdrLine").offsetHeight+"px";d.style.bottom="0";}};
sap.ui.ux3.Shell.prototype.setAppTitle=function(a){this.setProperty("appTitle",a,true);this._rerenderHeader();return this;};
sap.ui.ux3.Shell.prototype.setAppIcon=function(a){this.setProperty("appIcon",a,true);this._rerenderHeader();return this;};
sap.ui.ux3.Shell.prototype.setShowLogoutButton=function(s){this.setProperty("showLogoutButton",s,true);this._rerenderHeader();return this;};
sap.ui.ux3.Shell.prototype.insertHeaderItem=function(h,i){if(sap.ui.commons&&sap.ui.commons.Button&&(h instanceof sap.ui.commons.Button)){h.setStyled(false);}this.insertAggregation("headerItems",h,i,true);this._rerenderHeader();return this;};
sap.ui.ux3.Shell.prototype.addHeaderItem=function(h){if(sap.ui.commons&&sap.ui.commons.Button&&(h instanceof sap.ui.commons.Button)){h.setStyled(false);}this.addAggregation("headerItems",h,true);this._rerenderHeader();return this;};
sap.ui.ux3.Shell.prototype.removeHeaderItem=function(i){var r=this.removeAggregation("headerItems",i,true);this._rerenderHeader();return r;};
sap.ui.ux3.Shell.prototype.removeAllHeaderItems=function(){var r=this.removeAllAggregation("headerItems",true);this._rerenderHeader();return r;};
sap.ui.ux3.Shell.prototype.destroyHeaderItems=function(){this.destroyAggregation("headerItems",true);this._rerenderHeader();return this;};
sap.ui.ux3.Shell.prototype.setShowSearchTool=function(s){this.setProperty("showSearchTool",s,true);this._rerenderToolPalette();return this;};
sap.ui.ux3.Shell.prototype.setShowInspectorTool=function(s){this.setProperty("showInspectorTool",s,true);this._rerenderToolPalette();return this;};
sap.ui.ux3.Shell.prototype.setShowFeederTool=function(s){this.setProperty("showFeederTool",s,true);this._rerenderToolPalette();return this;};
sap.ui.ux3.Shell.prototype.insertToolPopup=function(t,i){this.insertAggregation("toolPopups",t,i,true);t.attachIconChanged(this._rerenderToolPalette,this);this._rerenderToolPalette();return this;};
sap.ui.ux3.Shell.prototype.addToolPopup=function(t){this.addAggregation("toolPopups",t,true);t.attachIconChanged(this._rerenderToolPalette,this);this._rerenderToolPalette();return this;};
sap.ui.ux3.Shell.prototype.removeToolPopup=function(i){var r=this.removeAggregation("toolPopups",i,true);this._rerenderToolPalette();return r;};
sap.ui.ux3.Shell.prototype.removeAllToolPopups=function(){var r=this.removeAllAggregation("toolPopups",true);this._rerenderToolPalette();return r;};
sap.ui.ux3.Shell.prototype.destroyToolPopups=function(){this.destroyAggregation("toolPopups",true);this._rerenderToolPalette();return this;};
sap.ui.ux3.Shell.prototype.insertContent=function(c,i){this.insertAggregation("content",c,i,true);this._rerenderContent();return this;};
sap.ui.ux3.Shell.prototype.addContent=function(c){this.addAggregation("content",c,true);this._rerenderContent();return this;};
sap.ui.ux3.Shell.prototype.removeContent=function(i){var r=this.removeAggregation("content",i,true);this._rerenderContent();return r;};
sap.ui.ux3.Shell.prototype.removeAllContent=function(){var r=this.removeAllAggregation("content",true);this._rerenderContent();return r;};
sap.ui.ux3.Shell.prototype.destroyContent=function(){this.destroyAggregation("content",true);this._rerenderContent();return this;};
sap.ui.ux3.Shell.prototype.addPaneBarItem=function(p){this.addAggregation("paneBarItems",p,true);this._rerenderPaneBarItems();return this;};
sap.ui.ux3.Shell.prototype.insertPaneBarItem=function(p,i){this.insertAggregation("paneBarItems",p,i,true);this._rerenderPaneBarItems();return this;};
sap.ui.ux3.Shell.prototype.removePaneBarItem=function(p){var r=this.removeAggregation("paneBarItems",p,true);this._rerenderPaneBarItems();return r;};
sap.ui.ux3.Shell.prototype.removeAllPaneBarItems=function(){var r=this.removeAllAggregation("paneBarItems",true);this._rerenderPaneBarItems();return r;};
sap.ui.ux3.Shell.prototype.destroyPaneBarItems=function(){this.destroyAggregation("paneBarItems",true);this._rerenderPaneBarItems();return this;};
sap.ui.ux3.Shell.prototype._rerenderHeader=function(){var $=jQuery.sap.byId(this.getId()+"-hdr");if($.length>0){var r=sap.ui.getCore().createRenderManager();sap.ui.ux3.ShellRenderer.renderHeader(r,this);r.flush($[0],true);r.destroy();}};
sap.ui.ux3.Shell.prototype._rerenderToolPalette=function(){var $=jQuery.sap.byId(this.getId()+"-tp");if($.length>0){var r=sap.ui.getCore().createRenderManager();this._beforeRenderingToolPalette();sap.ui.ux3.ShellRenderer.renderToolPalette(r,this);r.flush($[0],true);this._afterRenderingToolPalette();r.destroy();}};
sap.ui.ux3.Shell.prototype._beforeRenderingToolPalette=function(){jQuery.sap.byId(this.getId()+"-toolPalette").children(".sapUiUx3ShellTool").unbind("mouseenter mouseleave");};
sap.ui.ux3.Shell.prototype._afterRenderingToolPalette=function(){var s=this.getId()+sap.ui.ux3.Shell.TOOL_PREFIX;var t=this.getToolPopups();for(var i=0;i<t.length;i++){var o=t[i];if(o instanceof sap.ui.ux3.ToolPopup){jQuery.sap.byId(s+o.getId()).hover(function(e){jQuery(this).toggleClass("sapUiUx3ShellToolHover",(e.type==="mouseenter"));sap.ui.ux3.Shell._updateToolIcon(this);});}}};
sap.ui.ux3.Shell.prototype._rerenderContent=function(p){var $=jQuery.sap.byId(this.getId()+"-content");if($.length>0){var c=this.getContent(),r=sap.ui.getCore().createRenderManager();for(var i=0;i<c.length;i++){r.renderControl(c[i]);}r.flush($[0],p);r.destroy();}};
sap.ui.ux3.Shell.prototype._rerenderPane=function(p){var $=jQuery.sap.byId(this.getId()+"-paneContent");if($.length>0){var a=this.getPaneContent(),r=sap.ui.getCore().createRenderManager();for(var i=0;i<a.length;i++){r.renderControl(a[i]);}r.flush($[0],p);r.destroy();}};
sap.ui.ux3.Shell.prototype._rerenderPaneBarItems=function(){var p=jQuery.sap.byId(this.getId()+"-paneBar").find(".sapUiUx3ShellPaneEntries");if(p.length>0){var r=sap.ui.getCore().createRenderManager();sap.ui.ux3.ShellRenderer.renderPaneBarItems(r,this);r.flush(p[0]);r.destroy();this._updatePaneBarItemNavigation(p);}};
sap.ui.ux3.Shell.prototype.forceInvalidation=sap.ui.core.Control.prototype.invalidate;
sap.ui.ux3.Shell.prototype.invalidate=function(s){if(s==this){}else if(!s){this.forceInvalidation();}else if(s instanceof sap.ui.ux3.NavigationItem){this._oWorksetBar.setAssociatedItems(this.getWorksetItems());var w=this.getSelectedWorksetItem();if(w){var i;var a=sap.ui.getCore().byId(w);if(a&&a.getParent()instanceof sap.ui.ux3.NavigationItem){this._oFacetBar.setAssociatedItems(a.getParent().getSubItems());}else if(a&&(i=a.getSubItems())){if(i&&(i.length>0)){this._oFacetBar.setAssociatedItems(i);}}else{}}}else if((s instanceof sap.ui.core.Item)&&(s.getParent()==this)){this.forceInvalidation();}else if(s instanceof sap.ui.ux3.ToolPopup){}else if(this.indexOfHeaderItem(s)>=0){this._rerenderHeader();}else{}};
sap.ui.ux3.Shell.prototype._setParent=sap.ui.core.Control.prototype.setParent;
sap.ui.ux3.Shell.prototype.setParent=function(p,a,s){this._setParent(p,a,s);this.forceInvalidation();};
sap.ui.ux3.Shell.prototype.setContent=function(c,d){var o=[];var $=jQuery.sap.byId(this.getId()+"-content");var p=false;if(!d){o=this.removeAllAggregation("content",true);if($.length>0){sap.ui.core.RenderManager.preserveContent($[0]);p=true;$.empty();}}else{this.destroyAggregation("content",true);}if(c instanceof sap.ui.core.Control){this.addAggregation("content",c,true);}else if(c&&typeof(c)=="object"&&c.length){for(var i=0;i<c.length;i++){this.addAggregation("content",c[i],true);}}this._rerenderContent(p);return o;};
sap.ui.ux3.Shell.prototype.setPaneContent=function(c,d){var o=[];var $=jQuery.sap.byId(this.getId()+"-paneContent");var p=false;if(!d){o=this.removeAllAggregation("paneContent",true);if($.length>0){sap.ui.core.RenderManager.preserveContent($[0]);p=true;$.empty();}}else{this.destroyAggregation("paneContent",true);}if(c instanceof sap.ui.core.Control){this.addAggregation("paneContent",c,true);}else if(c&&typeof(c)=="object"&&c.length){for(var i=0;i<c.length;i++){this.addAggregation("paneContent",c[i],true);}}this._rerenderPane(p);return o;};
sap.ui.ux3.Shell.prototype.getSelectedWorksetItem=function(){return this.getAssociation("selectedWorksetItem");};
sap.ui.ux3.Shell.prototype.setSelectedWorksetItem=function(s){var o=this.getSelectedWorksetItem();this.setAssociation("selectedWorksetItem",s,true);var n=this.getSelectedWorksetItem();if(o!=n){var a=sap.ui.getCore().byId(n);if(a){this._sSelectedWorksetId=n;this._sSelectedFacetId=null;var b=a.getSubItems();if(b.length>0){a=b[0];}if(a&&(a.getParent()instanceof sap.ui.ux3.NavigationItem)){var c=a.getParent();this._sSelectedWorksetId=c.getId();this._sSelectedFacetId=a.getId();this._oWorksetBar.setSelectedItem(c);this._oFacetBar.setAssociatedItems(c.getSubItems());this._oFacetBar.setSelectedItem(a);if(this.getDomRef()){jQuery.sap.byId(this.getId()+"-facetBar").slideDown();}}else if(a){this._oWorksetBar.setSelectedItem(a);this._oFacetBar.setAssociatedItems([]);this._oFacetBar.setSelectedItem(null);if(this.getDomRef()){jQuery.sap.byId(this.getId()+"-facetBar").slideUp();}}else{}}else{throw new Error("WorksetItem with ID "+n+" cannot be found.");}}return this;};
sap.ui.ux3.Shell.prototype._handleDragover=function(e){var i=e.target.id;if(!this._dragOverBlinking){var $=jQuery.sap.byId(i);$.css("opacity","0.5");this._dragOverBlinking=true;var t=this;window.setTimeout(function(){$.css("opacity","1");window.setTimeout(function(){t._dragOverBlinking=null;},300);},300);}return false;};
sap.ui.ux3.Shell.prototype._handleDragend=function(e){return false;};
sap.ui.ux3.Shell.prototype._handleDrop=function(a){var i=a.target.id;a.preventDefault();var e=a.originalEvent;var f=e.dataTransfer.files[0];if(f){var r=new window.FileReader();r.onload=jQuery.proxy(function(b){var d=b.target.result;if(i==this.getId()+"-bgImg"){this._getPersonalization()._handleBackgroundImageChange(d,true);}else if(i==this.getId()+"-hdr"){this._getPersonalization()._handleHeaderImageChange(d,true);}else if(i==this.getId()+"-logoImg"){this._getPersonalization()._handleLogoImageChange(d,true);}r=null;},this);r.readAsDataURL(f);}};
sap.ui.ux3.Shell.prototype._getPersonalization=function(){if(!this.oPersonalization){jQuery.sap.require("sap.ui.ux3.ShellPersonalization");this.oPersonalization=new sap.ui.ux3.ShellPersonalization(this);}return this.oPersonalization;};
sap.ui.ux3.Shell.prototype.openPersonalizationDialog=function(){this._getPersonalization().openDialog();};
sap.ui.ux3.Shell.prototype.initializePersonalization=function(s){this._getPersonalization().initializeSettings(s);};
