/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 * 
 * (c) Copyright 2009-2012 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.ui.commons.ListBoxRenderer");jQuery.sap.require("sap.ui.core.Renderer");jQuery.sap.require("jquery.sap.strings");sap.ui.commons.ListBoxRenderer={};
sap.ui.commons.ListBoxRenderer.render=function(o,l){var a=o,r=sap.ui.commons.ListBoxRenderer;if(r.borderWidths===undefined){if(jQuery.browser.msie){var f=document.createElement("div");var s=sap.ui.getCore().getStaticAreaRef();s.appendChild(f);f.className="sapUiLbx";var $=jQuery(f);$.css("width","50px");$.css("min-width","100px");r.borderWidths=f.offsetWidth-100;s.removeChild(f);}else{r.borderWidths=0;}}if(!l.getVisible()){return;}a.addClass("sapUiLbx");var b=true;if(!l.getEditable()){a.addClass("sapUiLbxRo");b=false;}if(!l.getEnabled()){a.addClass("sapUiLbxDis");b=false;}if(b){a.addClass("sapUiLbxStd");}a.write("<div");a.writeControlData(l);var w=l.getWidth();a.addStyle("width",w);if(!w||(w=="auto")||(w=="inherit")){a.addClass("sapUiLbxFlexWidth");}a.writeClasses();var m=l.getMinWidth();var c=l.getMaxWidth();if(jQuery.browser.msie){m=r.fixWidth(m);c=r.fixWidth(c);}a.addStyle("min-width",m);a.addStyle("max-width",c);var d=false;if(l._bHeightInItems){if(l._sTotalHeight!=null){a.addStyle("height",l._sTotalHeight);}else{}}else{a.addStyle("height",l.getHeight());}a.writeStyles();if(sap.ui.commons.ListBox._fItemHeight==-1){d=true;sap.ui.commons.ListBox._fItemHeight=-2;}var t=l.getTooltip_AsString();if(t){a.writeAttributeEscaped("title",t);}a.write(">");this.renderItemList(l,a,d);a.write("</div>");};
sap.ui.commons.ListBoxRenderer.renderItemList=function(l,r,b){r.write("<ul id='"+l.getId()+"-list'");r.writeAttribute("tabindex",this.getTabIndex(l));r.writeAttribute("role","listbox");r.writeAccessibilityState(l,{multiselectable:l.getAllowMultiSelect()});r.write(">");var a=l.getItems(),c=0,d=0;for(var i=0;i<a.length;i++){if(!(a[i]instanceof sap.ui.core.SeparatorItem)){d++;}}var m=(jQuery.browser.msie&&(jQuery.browser.version==8||jQuery.browser.version==7));var e=l.getDisplaySecondaryValues();for(var i=0;i<a.length;i++){var f=a[i];if(f instanceof sap.ui.core.SeparatorItem){r.write("<div id='",f.getId(),"' class='sapUiLbxSep' role='separator'><hr/>");if(l.getDisplayIcons()){r.write("<hr/>");}if(e){r.write("<hr/>");}r.write("</div>");}else{r.write("<li");r.writeElementData(f);r.writeAttribute("data-sap-ui-lbx-index",i);r.addClass("sapUiLbxI");if(!f.getEnabled()){r.addClass("sapUiLbxIDis");r.writeAttribute("tabindex","-1");}if(l.isIndexSelected(i)){r.addClass("sapUiLbxISel");}r.writeClasses();var t=f.getText();var s=f.getAdditionalText?f.getAdditionalText():"";if(f.getTooltip_AsString()){r.writeAttributeEscaped("title",f.getTooltip_AsString());}else{r.writeAttributeEscaped("title",t+((e&&s)?"  --  "+s:""));}r.writeAccessibilityState(f,{selected:(i===l.getSelectedIndex()),setsize:d,posinset:c+1});r.writeAttribute("role","option");r.write(">");if(l.getDisplayIcons()){r.write("<span class='sapUiLbxIIco'><img src='");if(f.getIcon&&f.getIcon()){r.writeEscaped(f.getIcon());}else{r.write(sap.ui.resource('sap.ui.commons','img/1x1.gif'));}r.write("'/></span>");}r.write("<span class='sapUiLbxITxt");if(m&&!e){r.write(" sapUiLbxILastChild");}r.write("'");r.writeAttribute("id",f.getId()+"-txt");var o=l.getValueTextAlign();if(o){r.write("style='text-align:"+sap.ui.commons.ListBoxRenderer.getTextAlign(o,null)+"'");}r.write(">");if(t===""||t===null){r.write("&nbsp;");}else{r.writeEscaped(t);}if(e){r.write("</span><span class='sapUiLbxISec");if(m){r.write(" sapUiLbxILastChild");}r.write("'");var o=l.getSecondaryValueTextAlign();if(o){r.write("style='text-align:"+sap.ui.commons.ListBoxRenderer.getTextAlign(o,null)+"'");}r.write(">");r.writeEscaped(s);}r.write("</span></li>");c++;}}if(b&&(a.length==0)){r.write("<li id=\"");r.write(l.getId()+"-dummyItem");r.write("\" class=\"sapUiLbxI\"><span class=\"sapUiLbxITxt\">&nbsp;</span></li>");}r.write("</ul>");};
sap.ui.commons.ListBoxRenderer.fixWidth=function(c){if(sap.ui.commons.ListBoxRenderer.borderWidths>0){if(c&&jQuery.sap.endsWithIgnoreCase(c,"px")){var w=parseInt(c.substr(0,c.length-2),10);var n=w-sap.ui.commons.ListBoxRenderer.borderWidths;if(n>=0){return n+"px";}}}return c;};
sap.ui.commons.ListBoxRenderer.getTabIndex=function(l){if(l.getEnabled()&&l.getEditable()){return 0;}else{return-1;}};
sap.ui.commons.ListBoxRenderer.handleSelectionChanged=function(o){if(o.getDomRef()){var a=o.getItems();for(var i=0,l=a.length;i<l;i++){if(o.isIndexSelected(i)){jQuery.sap.byId(a[i].getId()).addClass("sapUiLbxISel").attr("aria-selected","true");}else{jQuery.sap.byId(a[i].getId()).removeClass("sapUiLbxISel").attr("aria-selected","false");}}}};
sap.ui.commons.ListBoxRenderer.handleARIAActivedescendant=function(l,i){var $=jQuery.sap.byId(l.getId()+"-list");if($.length>0){var a=$.children("li[data-sap-ui-lbx-index="+i+"]");$.attr("aria-activedescendant",a.attr("id"));}};
sap.ui.commons.ListBoxRenderer.getTextAlign=sap.ui.core.Renderer.getTextAlign;
