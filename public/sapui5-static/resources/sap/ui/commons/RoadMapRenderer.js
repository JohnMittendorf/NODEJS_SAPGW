/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 * 
 * (c) Copyright 2009-2012 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.ui.commons.RoadMapRenderer");(function(){sap.ui.commons.RoadMapRenderer={};sap.ui.commons.RoadMapRenderer.render=function(j,l){var p=j;l.doBeforeRendering();if(!l.getVisible()){return;}p.write("<div");p.writeControlData(l);p.addClass("sapUiRoadMap");p.writeClasses();p.writeAttribute("tabIndex","0");var t=l.getTooltip_AsString();if(t){p.writeAttributeEscaped("title",t);}p.writeAttribute("style","width:"+(l.getWidth()?l.getWidth():"100%")+";");p.write(">");r(p,l,true);p.write("<ul");p.writeAttribute("id",l.getId()+"-steparea");p.addClass("sapUiRoadMapStepArea");p.writeClasses();if(sap.ui.getCore().getConfiguration().getAccessibility()){p.writeAttribute("role","group");p.writeAttribute("aria-label",e("RDMP_DEFAULT_TOOLTIP",[]));if(t){p.writeAttributeEscaped("title",t);}}p.write(">");var s=l.getSteps();for(var i=0;i<s.length;i++){var q=s[i];if(q.getSubSteps().length>0){c(p,l,q);}else{a(p,l,q);}}p.write("</ul>");r(p,l,false);p.write("</div>");};sap.ui.commons.RoadMapRenderer.selectStepWithId=function(i,s){var j=i.getSelectedStep();if(j){jQuery.sap.byId(j).removeClass("sapUiRoadMapSelected");}if(s){jQuery.sap.byId(s).addClass("sapUiRoadMapSelected");}if(sap.ui.getCore().getConfiguration().getAccessibility()){if(j){jQuery.sap.byId(j+"-box").removeAttr("aria-checked");}if(s){jQuery.sap.byId(s+"-box").attr("aria-checked",true);}}};sap.ui.commons.RoadMapRenderer.selectStep=function(j,s,l,p,q,t){if(!t){sap.ui.commons.RoadMapRenderer.selectStepWithId(j,s.getId());}if(!l&&s.getSubSteps().length>0){var v=s.getSubSteps();var x=jQuery.sap.byId(s.getId());var y=x.hasClass("sapUiRoadMapExpanded");var z=1;var A=function(){z--;if(z>0){return;}if(q){q(!y?"expanded":"collapsed");}sap.ui.commons.RoadMapRenderer.updateStepArea(j);};var B=function(D,E,F){var G=jQuery.sap.byId(D);if(!jQuery.fx.off&&!p){G.width(E?"0px":j.iStepWidth);var H=jQuery.sap.byId(D+"-label");H.addClass("sapUiRoadMapHidden");if(E){G.toggleClass("sapUiRoadMapHidden");}G.animate({width:E?j.iStepWidth:"0px"},"fast",function(){if(!E){G.toggleClass("sapUiRoadMapHidden");}G.width("");H.removeClass("sapUiRoadMapHidden");if(F){F();}});}else{G.toggleClass("sapUiRoadMapHidden");if(F){F();}}};x.toggleClass("sapUiRoadMapExpanded");if(sap.ui.getCore().getConfiguration().getAccessibility()){var C=x.hasClass("sapUiRoadMapExpanded");jQuery.sap.byId(s.getId()+"-box").attr("aria-expanded",C);jQuery.sap.byId(s.getId()+"-expandend-box").attr("aria-expanded",C);}for(var i=0;i<v.length;i++){if(v[i].getVisible()){z++;B(v[i].getId(),!y,A);}}B(s.getId()+"-expandend",!y,A);}else{if(q){q("selected");}}};sap.ui.commons.RoadMapRenderer.updateStepArea=function(i){if(i.iStepWidth!=-1){var s=jQuery.sap.byId(i.getId()+"-steparea");var j=jQuery.sap.byId(i.getId()+"-Start");var l=jQuery.sap.byId(i.getId()+"-End");var p=jQuery.sap.byId(i.getId());var q=s.scrollLeft();var t=p.width()-j.outerWidth(true)-l.outerWidth(true);var v=i.getNumberOfVisibleSteps();var x=f(i);if(v<1){v=x;}else{v=Math.min(v,x);}var y=Math.floor(t/i.iStepWidth);var z=Math.min(v,y);s.width(z*i.iStepWidth).scrollLeft(q);u(i);}};sap.ui.commons.RoadMapRenderer.updateScrollArea=function(i,s){sap.ui.commons.RoadMapRenderer.updateStepArea(i);if(!s){var j=jQuery.sap.byId(i.getId()+"-steparea");var p=n(i,false);if(i.getFirstVisibleStep()){var l=jQuery.sap.byId(i.getFirstVisibleStep());p=h(j,l);}o(i,p+k()*j.scrollLeft(),true);}};sap.ui.commons.RoadMapRenderer.isVisibleRef=function(j,s){var l=jQuery.sap.byId(j.getId()+"-steparea");var p=l.children(":visible");for(var i=0;i<p.length;i++){var q=jQuery(p.get(i));if(q.attr("id")==s){var t=h(l,q);return t>=0&&t<l.width();}}return false;};sap.ui.commons.RoadMapRenderer.getFirstVisibleRef=function(j){var s=jQuery.sap.byId(j.getId()+"-steparea");var l=s.children(":visible");for(var i=0;i<l.length;i++){var p=jQuery(l.get(i));if(h(s,p)==0){return p;}}return null;};sap.ui.commons.RoadMapRenderer.setStepLabel=function(s,i){var l=i?jQuery.sap.escapeHTML(i):"";jQuery.sap.byId(s.getId()+"-label").html(l);jQuery.sap.byId(s.getId()+"-expandend-label").html(l);};sap.ui.commons.RoadMapRenderer.setStepEnabled=function(i,s,j){var l=jQuery.sap.byId(s.getId());var p=jQuery.sap.byId(s.getId()+"-expandend");if(j){l.removeClass("sapUiRoadMapDisabled");p.removeClass("sapUiRoadMapDisabled");if(sap.ui.getCore().getConfiguration().getAccessibility()){jQuery.sap.byId(s.getId()+"-box").removeAttr("aria-disabled");jQuery.sap.byId(s.getId()+"-expandend-box").removeAttr("aria-disabled");}return false;}else{var q=i.getSelectedStep()==s.getId();if(q){l.removeClass("sapUiRoadMapSelected");}l.addClass("sapUiRoadMapDisabled");p.addClass("sapUiRoadMapDisabled");if(sap.ui.getCore().getConfiguration().getAccessibility()){var t=jQuery.sap.byId(s.getId()+"-box");t.attr("aria-disabled",true);if(q){t.removeAttr("aria-checked");}jQuery.sap.byId(s.getId()+"-expandend-box").attr("aria-disabled",true);}return q;}};sap.ui.commons.RoadMapRenderer.setStepVisible=function(j,s,l,v){var p=jQuery.sap.byId(s.getId());var q=jQuery.sap.byId(s.getId()+"-expandend");var t=j.getSelectedStep()==s.getId();var x=s.getParent();if(l){if(x.getEnabled()&&x.getVisible()&&x.getExpanded()){if(v){p.removeClass("sapUiRoadMapHidden");}else{p.addClass("sapUiRoadMapHidden");}}}else{if(v){p.removeClass("sapUiRoadMapHidden");}else{p.addClass("sapUiRoadMapHidden");}var y=s.getSubSteps();if(y.length>0&&s.getExpanded()){if(v){q.removeClass("sapUiRoadMapHidden");}else{q.addClass("sapUiRoadMapHidden");}for(var i=0;i<y.length;i++){if(y[i].getVisible()){var z=jQuery.sap.byId(y[i].getId());if(j.getSelectedStep()==y[i].getId()){t=true;z.removeClass("sapUiRoadMapSelected");jQuery.sap.byId(y[i].getId()+"-box").removeAttr("aria-checked");}if(v){z.removeClass("sapUiRoadMapHidden");}else{z.addClass("sapUiRoadMapHidden");}}}}}return t;};sap.ui.commons.RoadMapRenderer.setRoadMapWidth=function(i,s){var j=jQuery.sap.byId(i.getId());j.attr("style","width:"+(s?s:"100%")+";");};sap.ui.commons.RoadMapRenderer.scrollToNextStep=function(i,s,j){var p=s;if(s=="first"||s=="last"){p=n(i,s=="last");}o(i,p,false,j);};sap.ui.commons.RoadMapRenderer.addEllipses=function(s){if(!s){return;}var j=jQuery.sap.byId(s.getId()+"-label");var i=jQuery.sap.escapeHTML(s.getLabel());var t=i+"";var l=jQuery("<label class=\"sapUiRoadMapTitle\" style=\"display:none;position:absolute;overflow:visible;font-weight:bold;height:auto\">"+t+"</label>");l.width(j.width());jQuery(sap.ui.getCore().getStaticAreaRef()).append(l);var p=false;while(t.length>0&&l.height()>j.height()){t=t.substr(0,t.length-1);l.html(t+"...");p=true;}if(p){var q=l.html();q=q.substr(0,q.length-3);q=jQuery.sap.escapeHTML(q);q="<span>"+q+"</span>";j.html(q);if(sap.ui.getCore().getConfiguration().getAccessibility()){j.attr("aria-label",s.getLabel());}j.attr("title",s.getLabel());}else{j.removeAttr("aria-label");j.attr("title",g(s));}l.remove();};var r=function(i,j,s){var t=s?"Start":"End";i.write("<div");i.writeAttribute("id",j.getId()+"-"+t);i.writeAttribute("tabindex","-1");var l=true;i.addClass(l?"sapUiRoadMap"+t+"Scroll":"sapUiRoadMap"+t+"Fixed");i.addClass("sapUiRoadMapDelim");i.addClass("sapUiRoadMapContent");i.writeClasses();i.write("></div>");};var a=function(j,l,s,p,q,t){j.write("<li");if(t){j.writeAttribute("id",t);}else{j.writeElementData(s);}var v=d(l,s);s.__stepName=v;var x=g(s);j.addClass("sapUiRoadMapContent");j.addClass("sapUiRoadMapStep");if(!s.getVisible()){j.addClass("sapUiRoadMapHidden");}if(s.getEnabled()){if(l.getSelectedStep()==s.getId()){j.addClass("sapUiRoadMapSelected");}}else{j.addClass("sapUiRoadMapDisabled");}if(p){for(var i=0;i<p.length;i++){j.addClass(p[i]);}}j.writeClasses();j.write(">");b(j,t?t:s.getId(),1);j.write("<div");j.writeAttribute("id",(t?t:s.getId())+"-box");j.writeAttribute("tabindex","-1");j.addClass("sapUiRoadMapStepBox");j.writeClasses();j.writeAttributeEscaped("title",x);w(j,l,s,q?true:false);j.write("><span>");j.write(v);j.write("</span>");if(q){q(j,l,s);}j.write("</div>");j.write("<label");j.writeAttribute("id",(t?t:s.getId())+"-label");j.writeAttribute("for",(t?t:s.getId())+"-box");j.addClass("sapUiRoadMapTitle");j.writeAttributeEscaped("title",x);j.writeClasses();j.write(">");var y=s.getLabel();if(y){j.writeEscaped(y);}j.write("</label>");b(j,t?t:s.getId(),2);j.write("</li>");};var g=function(s){var t=s.getTooltip_AsString();if(!t){if(sap.ui.getCore().getConfiguration().getAccessibility()){t=e("RDMP_DEFAULT_STEP_TOOLTIP",[s.__stepName]);}else{t="";}}return t;};var b=function(i,s,j){i.write("<div");i.writeAttribute("id",s+"-add"+j);i.addClass("sapUiRoadMapStepAdd"+j);i.writeClasses();i.write("></div>");};var w=function(i,j,s,l){if(!sap.ui.getCore().getConfiguration().getAccessibility()){return;}i.writeAttribute("role","treeitem");if(s.getEnabled()){i.writeAttribute("aria-checked",j.getSelectedStep()==s.getId());}else{i.writeAttribute("aria-disabled",true);}i.writeAttribute("aria-haspopup",l);i.writeAttribute("aria-level",s.getParent()instanceof sap.ui.commons.RoadMap?1:2);if(!l){return;}i.writeAttribute("aria-expanded",s.getExpanded());};var c=function(j,l,s){var p=function(j,l,x,y,z){j.write("<div");j.writeAttribute("id",x+"-ico");j.addClass("sapUiRoadMapStepIco");if(z){j.addClass(z);}j.writeClasses();j.write("></div>");};var q=s.getExpanded();a(j,l,s,q?["sapUiRoadMapExpanded"]:null,function(j,l,s){p(j,l,s.getId(),q?"roundtripstart.gif":"roundtrip.gif");});var t=s.getSubSteps();for(var i=0;i<t.length;i++){var v=["sapUiRoadMapSubStep"];if(!q&&t[i].getVisible()){v.push("sapUiRoadMapHidden");}a(j,l,t[i],v);}v=["sapUiRoadMapExpanded","sapUiRoadMapStepEnd"];if(!q){v.push("sapUiRoadMapHidden");}a(j,l,s,v,function(j,l,s){p(j,l,s.getId()+"-expandend","roundtripend.gif");},s.getId()+"-expandend");};var d=function(i,s){var p=s.getParent();if(p===i){return p.indexOfStep(s)+1;}var j=p.indexOfSubStep(s);if(j<26){return String.fromCharCode(97+j);}var l=Math.floor(j/26)-1;var q=j%26;return String.fromCharCode(97+l,97+q);};var u=function(i){var j=k();var s=jQuery.sap.byId(i.getId()+"-steparea");var l=m(s);var p=jQuery.sap.byId(i.getId()+"-Start");p.removeClass("sapUiRoadMapStartScroll").removeClass("sapUiRoadMapStartFixed");p.addClass(j*l>=i.iStepWidth?"sapUiRoadMapStartScroll":"sapUiRoadMapStartFixed");var q=jQuery.sap.byId(i.getId()+"-End");q.removeClass("sapUiRoadMapEndScroll").removeClass("sapUiRoadMapEndFixed");var t=s.get(0).scrollWidth-j*l-s.width()<i.iStepWidth;q.addClass(t?"sapUiRoadMapEndFixed":"sapUiRoadMapEndScroll");};var e=function(s,i){var j=sap.ui.getCore().getLibraryResourceBundle("sap.ui.commons");if(j){return j.getText(s,i);}return s;};var f=function(l){var p=0;var s=l.getSteps();for(var i=0;i<s.length;i++){if(s[i].getVisible()){p++;if(s[i].getExpanded()){p++;var q=s[i].getSubSteps();for(var j=0;j<q.length;j++){if(q[j].getVisible()){p++;}}}}}return p;};var h=function(s,j){var p=j.position().left;if(sap.ui.getCore().getConfiguration().getRTL()){p=s.width()-p-j.outerWidth();}return p;};var k=function(){return sap.ui.getCore().getConfiguration().getRTL()&&!jQuery.browser.msie?-1:1;};var m=function(s){if(sap.ui.getCore().getConfiguration().getRTL()&&jQuery.browser.webkit){return(-1)*(s.get(0).scrollWidth-s.scrollLeft()-s.width());}return s.scrollLeft();};var n=function(i,l){var s=jQuery.sap.byId(i.getId()+"-steparea").get(0).scrollWidth;if(sap.ui.getCore().getConfiguration().getRTL()&&jQuery.browser.webkit){return l?0:(-1)*s;}return l?s:0;};var o=function(i,j,s,l){var p=jQuery.sap.byId(i.getId()+"-steparea");p.stop(false,true);if(j=="next"){j=p.scrollLeft()+i.iStepWidth*k();}else if(j=="prev"){j=p.scrollLeft()-i.iStepWidth*k();}else if(j=="keep"){j=p.scrollLeft();}else{j=j*k();}var q=function(){u(i);if(l){var t=sap.ui.commons.RoadMapRenderer.getFirstVisibleRef(i);l(t.attr("id"));}};if(!jQuery.fx.off&&!s){p.animate({scrollLeft:j},"fast",q);}else{p.scrollLeft(j);q();}};}());
