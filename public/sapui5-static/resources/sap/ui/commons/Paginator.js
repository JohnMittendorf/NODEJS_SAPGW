/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 * 
 * (c) Copyright 2009-2012 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.ui.commons.Paginator");jQuery.sap.require("sap.ui.commons.library");jQuery.sap.require("sap.ui.core.Control");sap.ui.core.Control.extend("sap.ui.commons.Paginator",{metadata:{library:"sap.ui.commons",properties:{"currentPage":{type:"int",group:"Misc",defaultValue:1},"numberOfPages":{type:"int",group:"Misc",defaultValue:null}},events:{"page":{}}}});sap.ui.commons.Paginator.M_EVENTS={'page':'page'};sap.ui.commons.Paginator.MAX_NUMBER_PAGES=5;
sap.ui.commons.Paginator.prototype.init=function(){this.bShowAnimation=true;};
sap.ui.commons.Paginator.prototype.onclick=function(e){if(e&&e.target){var t=e.target;if(!t.id){t=t.parentNode;}if(t.id&&t.id!=this.getId()+"-pages"){var a=t.id.split("--");if(a.length>1){var l=a[a.length-1];var s=null;var i=this.getCurrentPage();var b=i;if(l.match(/^\d+$/)){s=sap.ui.commons.PaginatorEvent.Goto;b=parseInt(l,10);}else if(l=="firstPageLink"){s=sap.ui.commons.PaginatorEvent.First;b=1;}else if(l=="backLink"){s=sap.ui.commons.PaginatorEvent.Previous;b=Math.max(i-1,1);}else if(l=="forwardLink"){s=sap.ui.commons.PaginatorEvent.Next;b=Math.min(i+1,this.getNumberOfPages());}else if(l=="lastPageLink"){s=sap.ui.commons.PaginatorEvent.Last;b=this.getNumberOfPages();}else{}if(b!=i){if(this.bShowAnimation){this.setCurrentPage(b,true);this.triggerPaginatorAnimation();}else{this.setCurrentPage(b);}this.firePage({srcPage:i,targetPage:b,type:s});}}}}};
sap.ui.commons.Paginator.prototype.setCurrentPage=function(t,s){this.setProperty("currentPage",t,s);if(this.getDomRef()){sap.ui.commons.PaginatorRenderer.updateBackAndForward(this);}};
sap.ui.commons.Paginator.prototype.triggerPaginatorAnimation=function(){var a=[];var b=[];var p=this.getId();var c=jQuery.sap.byId(p+"-pages").children();var n=this._calculatePagesRange();var o;if(this._oOldRange){o=this._oOldRange;}else{o={};var d=c[0].id.split("--");o.firstPage=parseInt(d[d.length-1],10);d=c[c.length-1].id.split("--");o.lastPage=parseInt(d[d.length-1],10);}for(var i=n.firstPage;i<=n.lastPage;i++){if(i<o.firstPage||i>o.lastPage){b.push(i);}}var e={firstPage:b[0],lastPage:b[b.length-1]};for(var i=o.firstPage;i<=o.lastPage;i++){if(i<n.firstPage||i>n.lastPage){a.push(i);}}var f=sap.ui.commons.PaginatorRenderer.getPagesHtml(this.getId(),o,this.getCurrentPage(),true);var g=sap.ui.commons.PaginatorRenderer.getPagesHtml(this.getId(),e,this.getCurrentPage(),false);if(o.firstPage<e.firstPage){g=f+g;}else{g=g+f;}jQuery.sap.domById(this.getId()+"-pages").innerHTML=g;var h=this.getId()+"-li--";this._oOldRange=n;for(var i=0;i<a.length;i++){var j=h+a[i];jQuery.sap.byId(j).hide(400,function(){var j=this.id;var k=jQuery.sap.domById(j);if(k){k.parentNode.removeChild(k);}});}for(var i=0;i<b.length;i++){jQuery.sap.byId(h+b[i]).show(400);}};
sap.ui.commons.Paginator.prototype._calculatePagesRange=function(){var f=1;var l=this.getNumberOfPages();var c=this.getCurrentPage();var n=this.getNumberOfPages();if(c<4){f=1;if(l>sap.ui.commons.Paginator.MAX_NUMBER_PAGES){l=sap.ui.commons.Paginator.MAX_NUMBER_PAGES;}}else{if(c==l){if(n<5){f=1;}else{f=l-4;}}else if(l-c<3){f=l-4;}else{f=c-2;l=c+2;}}return{firstPage:f,lastPage:l};};
sap.ui.commons.Paginator.prototype.onkeydown=function(e){var a=e.getPseudoTypes();if(jQuery.inArray("saptabnext",a)!=-1){this.triggerTabbingNavigation(e,false);}else if(jQuery.inArray("saptabprevious",a)!=-1){this.triggerTabbingNavigation(e,true);}else if(jQuery.inArray("sapincrease",a)!=-1){this.triggerInternalNavigation(e,"next");}else if(jQuery.inArray("sapdecrease",a)!=-1){this.triggerInternalNavigation(e,"previous");}};
sap.ui.commons.Paginator.prototype.triggerInternalNavigation=function(e,d){var f=jQuery(jQuery.sap.domById(this.getId())).find(":focusable");var c=jQuery(f).index(e.target);if(d=="next"){var n=c+1;if(jQuery(e.target).hasClass("sapUiPagCurrentPage")){n=n+1;}var o=f[n];if(o){jQuery(o).focus();e.preventDefault();e.stopPropagation();}}else if(d=="previous"&&f[c-1]){var n=c-1;var o=f[n];if(o&&jQuery(o).hasClass("sapUiPagCurrentPage")){o=f[n-1];}if(o){jQuery(o).focus();e.preventDefault();e.stopPropagation();}}};
sap.ui.commons.Paginator.prototype.triggerTabbingNavigation=function(e,s){var f=jQuery(jQuery.sap.domById(this.getId())).find(":focusable");if(!s){jQuery(f[f.length-1]).focus();}else{var c=jQuery(f).index(e.target);if(c!=0){jQuery(f[0]).focus();}}};
